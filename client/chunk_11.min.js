(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1260:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=n(644),o=n(899),e.castTensor=function(t,e,n){if(!r.util.hasEncodingLoss(t.dtype,e))return r.Tensor.make(t.shape,{dataId:t.dataId},e);if("int32"===e)return n.int(t);if("bool"===e)return n.notEqual(t,o.ArrayOps.scalar(0,t.dtype));throw Error("Error in Cast: unknown dtype argument ("+e+")")},e.reshapeTensor=function(t,e){return r.Tensor.make(e,{dataId:t.dataId},t.dtype)}},1261:function(t,e,n){"use strict";var r,o,a;Object.defineProperty(e,"__esModule",{value:!0}),r=n(731),o="\n  if (isNaN(a)) return a;\n  if (isNaN(b)) return b;\n",e.ADD="return a + b;",e.SUB="return a - b;",e.MUL="return a * b;",e.DIV="return a / b;",e.INT_DIV="\n  float resultSign = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  int result = ia / ib;\n  int amodb = ia - ib * result;\n\n  if (resultSign < 0.0 && amodb != 0) {\n    result -= 1;\n  }\n  return float(result);\n",e.POW="\n  return (round(mod(b, 2.0)) == 0 || round(mod(b, 2.0)) == 2) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.SQUARED_DIFFERENCE="return (a - b) * (a - b);",e.EQUAL="return float(a == b);",e.NOT_EQUAL="return float(a != b);",e.LESS="return float(a < b);",e.LESS_EQUAL="return float(a <= b);",e.GREATER="return float(a > b);",e.GREATER_EQUAL="return float(a >= b);",e.LOGICAL_AND="return float(a >= 1.0 && b >= 1.0);",e.LOGICAL_OR="return float(a >= 1.0 || b >= 1.0);",e.MAX=o+"\n  return max(a, b);\n",e.MIN=o+"\n  return min(a, b);\n",e.MOD="return mod(a, b);",e.ATAN2=o+"\n  return atan(a, b);\n",e.ELU_DER="return (b >= 1.0) ? a : a * (b + 1.0);",a=function(t,e,n){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.outputShape=r.assertAndGetBroadcastShape(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},e.BinaryOpProgram=a},1262:function(t,e,n){"use strict";function r(t,e){return c.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===c.ENV.get("WEBGL_VERSION")?4===e?t.RGBA:t.RED:t.RGBA}function o(t){return c.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?t.FLOAT:t.UNSIGNED_BYTE}function a(t,e,n,a){var i,u,s,l;return p.validateTextureSize(t,e,n),i=p.createTexture(t),u=t.TEXTURE_2D,s=function(t,e){return c.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===c.ENV.get("WEBGL_VERSION")?4===e?t.RGBA32F:t.R32F:t.RGBA}(t,a),l=r(t,a),p.callAndCheck(t,(function(){return t.bindTexture(u,i)})),p.callAndCheck(t,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),p.callAndCheck(t,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),p.callAndCheck(t,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),p.callAndCheck(t,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),p.callAndCheck(t,(function(){return t.texImage2D(u,0,s,e,n,0,l,o(t),null)})),p.callAndCheck(t,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),i}function i(t,e,n,a,i,u){var s=r(t,u);p.validateTextureSize(t,n,a),p.callAndCheck(t,(function(){return t.bindTexture(t.TEXTURE_2D,e)})),p.callAndCheck(t,(function(){return t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,a,s,o(t),i)})),p.callAndCheck(t,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function u(t,e,n){return c.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?new Float32Array(l.getUnpackedArraySizeFromMatrixSize(t*e,n)):new Uint8Array(t*e*n)}function s(t,e,n,r){var o;return c.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?(o=new Float32Array(e*n),l.decodeMatrixFromUnpackedArray(t,o,r),o):l.decodeToFloatArray(t)}var c,l,p,f=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{s(r.next(t))}catch(e){a(e)}}function u(t){try{s(r.throw(t))}catch(e){a(e)}}function s(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(i,u)}s((r=r.apply(t,e||[])).next())}))},h=this&&this.__generator||function(t,e){function n(n){return function(i){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!((a=(a=u.trys).length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(i){n=[6,i],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,i])}}var r,o,a,i,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(e,"__esModule",{value:!0}),c=n(632),l=n(829),p=n(900),e.getWebGLContextAttributes=function(){return{alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0}},e.createWebGLContext=function(t){var e,n={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};return e=null!=t?p.createWebGLRenderingContextFromCanvas(t,n):p.createWebGLRenderingContext(n),p.callAndCheck(e,(function(){return e.disable(e.DEPTH_TEST)})),p.callAndCheck(e,(function(){return e.disable(e.STENCIL_TEST)})),p.callAndCheck(e,(function(){return e.disable(e.BLEND)})),p.callAndCheck(e,(function(){return e.disable(e.DITHER)})),p.callAndCheck(e,(function(){return e.disable(e.POLYGON_OFFSET_FILL)})),p.callAndCheck(e,(function(){return e.disable(e.SAMPLE_COVERAGE)})),p.callAndCheck(e,(function(){return e.enable(e.SCISSOR_TEST)})),p.callAndCheck(e,(function(){return e.enable(e.CULL_FACE)})),p.callAndCheck(e,(function(){return e.cullFace(e.BACK)})),e},e.createVertexShader=function(t){return p.createVertexShader(t,"\n    precision highp float;\n    attribute vec3 clipSpacePos;\n    attribute vec2 uv;\n    varying vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")},e.createVertexBuffer=function(t){var e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return p.createStaticVertexBuffer(t,e)},e.createIndexBuffer=function(t){var e=new Uint16Array([0,1,2,2,1,3]);return p.createStaticIndexBuffer(t,e)},e.createMatrixTexture=function(t,e,n){var r=l.getUnpackedMatrixTextureShapeWidthHeight(e,n);return a(t,r[0],r[1],1)},e.createColorMatrixTexture=function(t,e,n){var r=l.getColorMatrixTextureShapeWidthHeight(e,n);return a(t,r[0],r[1],4)},e.createPackedMatrixTexture=function(t,e,n){var r=l.getPackedMatrixTextureShapeWidthHeight(e,n);return a(t,r[0],r[1],4)},e.bindVertexProgramAttributeStreams=function(t,e,n){return p.callAndCheck(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,n)})),p.bindVertexBufferToProgramAttribute(t,e,"clipSpacePos",n,3,20,0)&&p.bindVertexBufferToProgramAttribute(t,e,"uv",n,2,20,12)},e.uploadPixelDataToTexture=function(t,e,n){p.callAndCheck(t,(function(){return t.bindTexture(t.TEXTURE_2D,e)})),p.callAndCheck(t,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)})),p.callAndCheck(t,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},e.uploadMatrixToTexture=function(t,e,n,r,o,a){var u,s,f=l.getUnpackedMatrixTextureShapeWidthHeight(n,r),h=f[0],d=f[1];c.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?1===(s=1===a?p.getChannelsPerTexture():a)?u=o:(u=new Float32Array(l.getUnpackedArraySizeFromMatrixSize(o.length,s)),l.encodeMatrixToUnpackedArray(o,u,s)):u=l.encodeFloatArray(o),i(t,e,h,d,u,a)},e.uploadMatrixToPackedTexture=function(t,e,n,r,o){var a=l.getPackedMatrixTextureShapeWidthHeight(n,r),u=a[0],s=a[1],c=new Float32Array(l.getPackedRGBAArraySizeFromMatrixShape(n,r));l.encodeMatrixToPackedRGBA(o,n,r,c),i(t,e,u,s,c,4)},e.downloadMatrixFromOutputTextureAsync=function(t,e,n,r){return f(this,void 0,void 0,(function(){var a,i,c,l,f;return h(this,(function(h){switch(h.label){case 0:return a=t,c=u(n,r,i=4),l=c instanceof Float32Array?4*c.length:c,f=t.createBuffer(),p.callAndCheck(t,(function(){return t.bindBuffer(a.PIXEL_PACK_BUFFER,f)})),p.callAndCheck(t,(function(){return t.bufferData(a.PIXEL_PACK_BUFFER,l,t.STATIC_DRAW)})),p.callAndCheck(t,(function(){return a.readPixels(0,0,r,n,t.RGBA,o(t),0)})),[4,e.getBufferSubDataAsync(a.PIXEL_PACK_BUFFER,0,c)];case 1:return h.sent(),[2,s(c,n,r,i)]}}))}))},e.downloadMatrixFromOutputTexture=function(t,e,n){var r=l.getUnpackedMatrixTextureShapeWidthHeight(e,n),a=r[0],i=r[1],c=u(e,n,4);return p.callAndCheck(t,(function(){return t.readPixels(0,0,a,i,t.RGBA,o(t),c)})),s(c,e,n,4)},e.downloadMatrixFromRGBAColorTexture=function(t,e,n,r){var o,a,i,u=e*n*4,s=new Uint8Array(u);for(p.callAndCheck(t,(function(){return t.readPixels(0,0,n,e,t.RGBA,t.UNSIGNED_BYTE,s)})),o=new Float32Array(u),a=0;a<s.length;a++)o[a]=s[a];return i=new Float32Array(e*n*r),l.decodeMatrixFromUnpackedColorRGBAArray(o,i,r),i},e.downloadMatrixFromPackedOutputTexture=function(t,e,n){var r,a=l.getPackedMatrixTextureShapeWidthHeight(e,n),i=a[0],u=a[1],s=new Float32Array(l.getPackedRGBAArraySizeFromMatrixShape(e,n));return p.callAndCheck(t,(function(){return t.readPixels(0,0,i,u,t.RGBA,o(t),s)})),r=new Float32Array(e*n),l.decodeMatrixFromPackedRGBA(s,e,n,r)}},1263:function(t,e,n){"use strict";var r,o,a,i;Object.defineProperty(e,"__esModule",{value:!0}),r=n(1039),o=n(1264),a=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},e.UnaryOpProgram=a,i="if (isNaN(x)) return x;",e.ABS="return abs(x);",e.RELU="return (x < 0.0) ? 0.0 : x;",e.ELU="return (x >= 0.0) ? x : (exp(x) - 1.0);",e.SELU="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+r.SELU_SCALEALPHA+";\n  float scale = "+r.SELU_SCALE+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",e.STEP=function(t){return void 0===t&&(t=0),i+"\n    return x > 0.0 ? 1.0 : float("+t+");\n  "},e.NEG="return -x;",e.CEIL="return ceil(x);",e.FLOOR="return floor(x);",e.SIGN="return sign(x);",e.ROUND="\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n",e.EXP="return exp(x);",e.EXPM1="return exp(x) - 1.0;",e.LOG="return log(x);",e.LOG1P="return log(1.0 + x);",e.SQRT="return sqrt(x);",e.RSQRT="return inversesqrt(x);",e.SIGMOID="return 1.0 / (1.0 + exp(-1.0 * x));",e.SOFTPLUS="\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n",e.SIN="return sin(x);",e.COS="return cos(x);",e.TAN="return tan(x);",e.ASIN="return asin(x);",e.ACOS="return acos(x);",e.ATAN=i+"\n  return atan(x);\n",e.SINH="\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n",e.COSH="\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n",e.TANH="\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n",e.ASINH="return log(x + sqrt(x * x + 1.0));",e.ACOSH="return log(x + sqrt(x * x - 1.0));",e.ATANH="return (log(1.0 + x) - log(1.0 - x)) / 2.0;",e.ERF='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas, \n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '+o.ERF_P+";\n  float a1 = "+o.ERF_A1+";\n  float a2 = "+o.ERF_A2+";\n  float a3 = "+o.ERF_A3+";\n  float a4 = "+o.ERF_A4+";\n  float a5 = "+o.ERF_A5+";\n  \n  float t = 1.0 / (1.0 + p * x);\n  return 1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x);\n",e.SQUARE="return x * x;",e.RECIPROCAL="return 1.0 / x;",e.LOGICAL_NOT="return float(!(x >= 1.0));",e.TO_INT="return float(int(x));"},1274:function(t,e,n){"use strict";var r,o,a,i,u,s=this&&this.__extends||(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),r=n(711),o=n(783),a=n(735),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.getTfjsPadding=function(t,e){var n=null!==e&&"VALID"!=e,r=null!==t&&t.length>0&&0!=t[0];return n||r?"same":"valid"},e.getConvDim=function(t){var e=a.getNamedAttrs(t.attribute);return a.parseAttrOrDefault(e.kernel_shape,[]).length||2},e.prototype.getTfjsLayerConfig=function(t){var n=a.getNamedAttrs(t.attribute),r=a.parseAttrOrDefault(n.kernel_shape),i=a.parseAttrOrDefault(n.strides,1),u=a.parseAttrOrDefault(n.pads,null),s=a.parseAttrOrDefault(n.auto_pad,null),c=e.getTfjsPadding(u,s),l=a.parseAttrOrDefault(n.dilations,1),p=t.input[1],f=t.input[2],h=this.model.blobShapes[p][0],d=this.model.blobValues[p],g=this.model.blobValues[f];return{kernelSize:r,strides:i,padding:c,dilationRate:l,filters:h,kernelInitializer:new o.WeightInitializer(d),biasInitializer:new o.WeightInitializer(g)}},e.prototype.getTfjsLayer=function(t){var n=e.getConvDim(t),o=this.getTfjsConfig(t);return 1==n?r.layers.conv1d(o):r.layers.conv2d(o)},e}(o.OnnxNode),e.Conv=i},2132:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=n(2133),o=n(735),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(711)),e.onnx={util:o,loadModel:r.load}},2133:function(t,e,n){"use strict";var r,o,a,i,u,s,c,l,p,f,h=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{s(r.next(t))}catch(e){a(e)}}function u(t){try{s(r.throw(t))}catch(e){a(e)}}function s(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(i,u)}s((r=r.apply(t,e||[])).next())}))},d=this&&this.__generator||function(t,e){function n(n){return function(i){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!((a=(a=u.trys).length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(i){n=[6,i],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,i])}}var r,o,a,i,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(e,"__esModule",{value:!0}),r=n(711),o=n(2218),a=n(2235),i=n(1274),u=n(2236),s=n(2237),c=n(2238),l=n(735),p={Add:s.Add,AveragePool:c.AveragePool,Concat:s.Concat,Conv:i.Conv,Dropout:u.Dropout,Elu:o.Elu,FC:u.Dense,Flatten:u.Flatten,GlobalAveragePool:c.GlobalAveragePool,GlobalMaxPool:c.GlobalMaxPool,HardSigmoid:o.HardSigmoid,MaxPool:c.MaxPool,Mul:s.Mul,Relu:o.Relu,Reshape:u.Reshape,Sigmoid:o.Sigmoid,Softmax:a.Softmax,Softplus:o.Softplus,Softsign:o.Softsign,Tanh:o.Tanh},e.load=function(t){return h(this,void 0,void 0,(function(){var e;return d(this,(function(n){switch(n.label){case 0:return[4,(e=new f(t)).load()];case 1:return n.sent(),[2,e.getModel()]}}))}))},f=function(){function t(t){this.modelUrl=t}return t.prototype.load=function(){return h(this,void 0,void 0,(function(){var t;return d(this,(function(e){switch(e.label){case 0:return t=this,[4,l.loadOnnxModel(this.modelUrl)];case 1:return t.onnx=e.sent(),this.graph=this.onnx.graph,this.blobShapes=l.getBlobShapes(this.graph),this.blobValues=l.getBlobValues(this.graph),[2]}}))}))},t.prototype.getModel=function(){var t,e,n,o,a=this,i=this.graph.output.map((function(t){return t.name})),u=this.graph.input[this.graph.input.length-1].name,s={shape:l.getInputShape(this.blobShapes[u])},c=r.input(s);for(this.blobs={},this.blobs[u]=c,t=function(t){var n,r,o,i,u=e.graph.node[t],s=[];for(n=0;n<u.input.length;++n)r=u.input[n],e.blobs.hasOwnProperty(r)&&s.push(e.blobs[r]);o=e.getTfjsLayer(u,s),s.length>0&&(i=o.apply(s),u.output.forEach((function(t){a.blobs[t]=i})))},e=this,n=0;n<this.graph.node.length;++n)t(n);return o={inputs:c,outputs:i.map((function(t){return a.blobs[t]})),name:this.graph.name},r.model(o)},t.prototype.getLayers=function(t){var e=this,n=t.node,r=n.map((function(t){return e.getTfjsLayer(t)})),o=n.map((function(t){return t.output[0]}));return l.joinArraysToObj(o,r)},t.prototype.getTfjsLayer=function(t,e){if(p.hasOwnProperty(t.opType))return p[t.opType].from(this).getTfjsLayer(t,e);throw Error("'"+t.opType+"' is not implemented in tfjs-onnx.")},t}(),e.OnnxModel=f},2134:function(t,e,n){"use strict";var r,o,a,i,u,s,c,l,p,f,h,d,g,y,m,v,x,T,b,E,A,C,w,R,S,_,O,P,M,N,I,k,D,L,F,B,U,V,G,W,j,z,X,H=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{s(r.next(t))}catch(e){a(e)}}function u(t){try{s(r.throw(t))}catch(e){a(e)}}function s(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(i,u)}s((r=r.apply(t,e||[])).next())}))},Q=this&&this.__generator||function(t,e){function n(n){return function(i){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!((a=(a=u.trys).length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(i){n=[6,i],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,i])}}var r,o,a,i,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(e,"__esModule",{value:!0}),r=n(632),o=n(713),a=n(656),i=n(2168),u=n(712),s=n(756),c=n(630),l=n(1260),p=n(2169),f=n(2170),h=n(2171),d=n(1261),g=n(1261),y=n(2172),m=n(2173),v=n(2174),x=n(2175),T=n(2176),b=n(2177),E=n(2178),A=n(2179),C=n(2180),w=n(2181),R=n(2182),S=n(2183),_=n(2184),O=n(2185),P=n(2186),M=n(2187),N=n(2188),I=n(2189),k=n(2190),D=n(2191),L=n(2192),F=n(2193),B=n(829),U=n(2194),V=n(2195),G=n(2196),W=n(1263),j=n(1263),z=n(900),X=function(){function t(t,e){if(void 0===e&&(e=!0),this.gpgpu=t,this.delayedStorage=e,this.texData=new WeakMap,this.uploadWaitMs=0,this.downloadWaitMs=0,this.binaryCache={},this.disposed=!1,r.ENV.get("WEBGL_VERSION")<1)throw Error("WebGL is not supported on this device");null==t?(this.gpgpu=new A.GPGPUContext,this.gpgpuCreatedLocally=!0):this.gpgpuCreatedLocally=!1,"undefined"!=typeof document&&(this.canvas=document.createElement("canvas")),this.textureManager=new U.TextureManager(this.gpgpu)}return t.prototype.register=function(t,e,n){if(this.texData.has(t))throw Error("Data buffer is already registered");this.texData.set(t,{shape:e,dtype:n,values:null,texture:null,texShape:null,texType:B.TextureType.FLOAT})},t.prototype.fromPixels=function(t,e){var n,r,o,a,i;if(null==t)throw Error("MathBackendWebGL.writePixels(): pixels can not be null");if(n=[t.height,t.width],r=[t.height,t.width,e],t instanceof HTMLVideoElement){if(null==this.canvas)throw Error("Can't read pixels from HTMLImageElement outside the browser.");this.canvas.width=t.width,this.canvas.height=t.height,this.canvas.getContext("2d").drawImage(t,0,0,t.width,t.height),t=this.canvas}return o=u.Tensor.make(n,{},"int32"),this.texData.get(o.dataId).texType=B.TextureType.UNSIGNED_BYTE,this.gpgpu.uploadPixelDataToTexture(this.getTexture(o.dataId),t),a=new b.FromPixelsProgram(r),i=this.compileAndRun(a,[o]),o.dispose(),i},t.prototype.write=function(t,e){var n,r,o,a;if(null==e)throw Error("MathBackendWebGL.write(): values can not be null");this.throwIfNoData(t),r=(n=this.texData.get(t)).texture,o=n.texShape,a=n.texType,null!=r&&(this.textureManager.releaseTexture(r,o,a),n.texture=null,n.texShape=null),n.values=e,this.delayedStorage||this.uploadToGPU(t)},t.prototype.readSync=function(t){var e,n,r,o,a,i,u;return this.throwIfNoData(t),n=(e=this.texData.get(t)).texture,r=e.values,o=e.texShape,null!=r?(this.cacheOnCPU(t),r):((a=null!=this.activeTimers)&&(i=performance.now()),u=this.gpgpu.downloadMatrixFromTexture(n,o[0],o[1]),a&&(this.downloadWaitMs+=performance.now()-i),this.cacheOnCPU(t,u),e.values)},t.prototype.read=function(t){return H(this,void 0,void 0,(function(){var e,n,o,a,i;return Q(this,(function(u){switch(u.label){case 0:return this.throwIfNoData(t),e=this.texData.get(t),n=e.texture,o=e.values,a=e.texShape,null!=o?(this.cacheOnCPU(t),[2,o]):r.ENV.get("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED")?[4,this.gpgpu.downloadMatrixFromTextureAsync(n,a[0],a[1])]:[3,2];case 1:return i=u.sent(),this.cacheOnCPU(t,i),[2,e.values];case 2:return 0===r.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?[2,this.readSync(t)]:[4,this.gpgpu.runQuery((function(){}))];case 3:return u.sent(),[2,this.readSync(t)]}}))}))},t.prototype.time=function(t){return H(this,void 0,void 0,(function(){var e,n,r,o,a,i;return Q(this,(function(u){switch(u.label){case 0:return e=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t(),o=c.flatten(this.activeTimers),this.activeTimers=e,r&&(this.programTimersStack=null),[4,Promise.all(o).then((function(t){var e=0;return t.forEach((function(t){return e+=t})),e}))];case 1:return a=u.sent(),i={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:a,wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,i]}}))}))},t.prototype.memory=function(){return{unreliable:!1}},t.prototype.startTimer=function(){return r.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:performance.now(),endMs:null}},t.prototype.endTimer=function(t){return r.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),t):(t.endMs=performance.now(),t)},t.prototype.getQueryTime=function(t){return H(this,void 0,void 0,(function(){var e;return Q(this,(function(n){return r.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.pollQueryTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},t.prototype.disposeData=function(t){if(this.texData.has(t)){var e=this.texData.get(t),n=e.texture,r=e.texShape,o=e.texType;null!=n&&this.textureManager.releaseTexture(n,r,o),this.texData.delete(t)}},t.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},t.prototype.getTextureData=function(t){return this.uploadToGPU(t),this.texData.get(t)},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.slice=function(t,e,n){var r=new F.SliceProgram(n),o=r.getCustomSetupFunc(e);return this.compileAndRun(r,[t],null,o)},t.prototype.reverse=function(t,e){var n=new L.ReverseProgram(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.concat=function(t,e){var n=new m.ConcatProgram(t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.neg=function(t){var e=new j.UnaryOpProgram(t.shape,W.NEG);return this.compileAndRun(e,[t])},t.prototype.matMul=function(t,e,n,r){var o=new _.MatMulProgram(t.shape,e.shape,n,r);return this.compileAndRun(o,[t,e])},t.prototype.multiply=function(t,e){var n=new g.BinaryOpProgram(d.MUL,t.shape,e.shape),r=this.makeOutputArray(n.outputShape,s.upcastType(t.dtype,e.dtype));return this.compileAndRun(n,[t,e],r)},t.prototype.batchNormalization=function(t,e,n,r,o,a){var i,u,s=[t,e,n],c=null;return null!=a&&(c=a.shape,s.push(a)),i=null,null!=o&&(i=o.shape,s.push(o)),u=new h.BatchNormProgram(t.shape,e.shape,n.shape,c,i,r),this.compileAndRun(u,s)},t.prototype.localResponseNormalization4D=function(t,e,n,r,o){var a=new R.LRNProgram(t.shape,e,n,r,o);return this.compileAndRun(a,[t])},t.prototype.tile=function(t,e){var n=new V.TileProgram(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.pad=function(t,e,n){var r=new M.PadProgram(t.shape,e,n);return this.compileAndRun(r,[t])},t.prototype.transpose=function(t,e){var n=new G.TransposeProgram(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.gather=function(t,e,n){var r=new E.GatherProgram(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},t.prototype.reduce=function(t,e,n){var r=t.shape[0],o=t.shape[1],a={windowSize:i.computeOptimalWindowSize(o),inSize:o,batchSize:r},u=new I.ReduceProgram(a,e),s=u.outputShape,c=s[0],l=s[1],p=this.makeOutputArray([c,l],n);return this.compileAndRun(u,[t],p),1===p.shape[1]?p:this.reduce(p,e,n)},t.prototype.argReduce=function(t,e,n){var r,o,a,u,s,c,l,f,h;return void 0===n&&(n=null),r=t.shape[0],o=t.shape[1],null!=n&&(r=n.shape[0],o=n.shape[1]),a={windowSize:i.computeOptimalWindowSize(o),inSize:o,batchSize:r},c=(s=(u=new p.ArgMinMaxProgram(a,e,null==n)).outputShape)[0],l=s[1],f=this.makeOutputArray([c,l],"int32"),h=[t],null!=n&&h.push(n),this.compileAndRun(u,h,f),1===f.shape[1]?f:this.argReduce(t,e,f)},t.prototype.sum=function(t,e){var n,r,a,i,u,l;return o.assertAxesAreInnerMostDims("sum",e,t.rank),r=(n=o.computeOutAndReduceShapes(t.shape,e))[0],a=n[1],i=c.sizeFromShape(a),u=t.as2D(-1,i),l=s.sumOutType(t.dtype),this.reduce(u,"sum",l).reshape(r)},t.prototype.argMin=function(t,e){var n,r,a,i,u,s=[e];return o.assertAxesAreInnerMostDims("argMin",s,t.rank),r=(n=o.computeOutAndReduceShapes(t.shape,s))[0],a=n[1],i=c.sizeFromShape(a),u=t.as2D(-1,i),this.argReduce(u,"min").reshape(r)},t.prototype.argMax=function(t,e){var n,r,a,i,u,s=[e];return o.assertAxesAreInnerMostDims("argMax",s,t.rank),r=(n=o.computeOutAndReduceShapes(t.shape,s))[0],a=n[1],i=c.sizeFromShape(a),u=t.as2D(-1,i),this.argReduce(u,"max").reshape(r)},t.prototype.equal=function(t,e){var n=new g.BinaryOpProgram(d.EQUAL,t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.notEqual=function(t,e){var n=new g.BinaryOpProgram(d.NOT_EQUAL,t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.less=function(t,e){var n=new g.BinaryOpProgram(d.LESS,t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.lessEqual=function(t,e){var n=new g.BinaryOpProgram(d.LESS_EQUAL,t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greater=function(t,e){var n=new g.BinaryOpProgram(d.GREATER,t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greaterEqual=function(t,e){var n=new g.BinaryOpProgram(d.GREATER_EQUAL,t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalNot=function(t){var e=new j.UnaryOpProgram(t.shape,W.LOGICAL_NOT);return this.compileAndRun(e,[t])},t.prototype.logicalAnd=function(t,e){var n=new g.BinaryOpProgram(d.LOGICAL_AND,t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalOr=function(t,e){var n=new g.BinaryOpProgram(d.LOGICAL_OR,t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.where=function(t,e,n,r){var o=new w.WhereProgram(t.rank,e.shape,e.rank),a=this.makeOutputArray(o.outputShape,r);return this.compileAndRun(o,[t,e,n],a)},t.prototype.topKValues=function(t,e){throw Error("topKValues GPU not yet implemented!")},t.prototype.topKIndices=function(t,e){throw Error("topKIndices GPU not yet implemented!")},t.prototype.min=function(t,e){var n,r,a,i,u;return o.assertAxesAreInnerMostDims("min",e,t.rank),r=(n=o.computeOutAndReduceShapes(t.shape,e))[0],a=n[1],i=c.sizeFromShape(a),u=t.as2D(-1,i),this.reduce(u,"min",u.dtype).reshape(r)},t.prototype.minimum=function(t,e){var n=new g.BinaryOpProgram(d.MIN,t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.mod=function(t,e){var n=new g.BinaryOpProgram(d.MOD,t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.max=function(t,e){var n,r,a,i,u;return o.assertAxesAreInnerMostDims("max",e,t.rank),r=(n=o.computeOutAndReduceShapes(t.shape,e))[0],a=n[1],i=c.sizeFromShape(a),u=t.as2D(-1,i),this.reduce(u,"max",u.dtype).reshape(r)},t.prototype.maximum=function(t,e){var n=new g.BinaryOpProgram(d.MAX,t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.squaredDifference=function(t,e){var n=new g.BinaryOpProgram(d.SQUARED_DIFFERENCE,t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.divide=function(t,e){var n,r,o,a;return"int32"===t.dtype&&"int32"===e.dtype?(n=d.INT_DIV,r="int32"):(n=d.DIV,r="float32"),o=new g.BinaryOpProgram(n,t.shape,e.shape),a=this.makeOutputArray(o.outputShape,r),this.compileAndRun(o,[t,e],a)},t.prototype.add=function(t,e){var n=new g.BinaryOpProgram(d.ADD,t.shape,e.shape),r=this.makeOutputArray(n.outputShape,s.upcastType(t.dtype,e.dtype));return this.compileAndRun(n,[t,e],r)},t.prototype.subtract=function(t,e){var n=new g.BinaryOpProgram(d.SUB,t.shape,e.shape),r=this.makeOutputArray(n.outputShape,s.upcastType(t.dtype,e.dtype));return this.compileAndRun(n,[t,e],r)},t.prototype.pow=function(t,e){var n=new g.BinaryOpProgram(d.POW,t.shape,e.shape),r=this.makeOutputArray(n.outputShape,s.upcastType(t.dtype,e.dtype));return this.compileAndRun(n,[t,e],r)},t.prototype.ceil=function(t){var e=new j.UnaryOpProgram(t.shape,W.CEIL);return this.compileAndRun(e,[t])},t.prototype.floor=function(t){var e=new j.UnaryOpProgram(t.shape,W.FLOOR);return this.compileAndRun(e,[t])},t.prototype.sign=function(t){var e=new j.UnaryOpProgram(t.shape,W.SIGN);return this.compileAndRun(e,[t])},t.prototype.round=function(t){var e=new j.UnaryOpProgram(t.shape,W.ROUND);return this.compileAndRun(e,[t])},t.prototype.exp=function(t){var e=new j.UnaryOpProgram(t.shape,W.EXP);return this.compileAndRun(e,[t])},t.prototype.expm1=function(t){var e=new j.UnaryOpProgram(t.shape,W.EXPM1);return this.compileAndRun(e,[t])},t.prototype.log=function(t){var e=new j.UnaryOpProgram(t.shape,W.LOG);return this.compileAndRun(e,[t])},t.prototype.log1p=function(t){var e=new j.UnaryOpProgram(t.shape,W.LOG1P);return this.compileAndRun(e,[t])},t.prototype.sqrt=function(t){var e=new j.UnaryOpProgram(t.shape,W.SQRT);return this.compileAndRun(e,[t])},t.prototype.rsqrt=function(t){var e=new j.UnaryOpProgram(t.shape,W.RSQRT);return this.compileAndRun(e,[t])},t.prototype.square=function(t){var e=new j.UnaryOpProgram(t.shape,W.SQUARE);return this.compileAndRun(e,[t])},t.prototype.reciprocal=function(t){var e=new j.UnaryOpProgram(t.shape,W.RECIPROCAL);return this.compileAndRun(e,[t])},t.prototype.relu=function(t){var e=new j.UnaryOpProgram(t.shape,W.RELU);return this.compileAndRun(e,[t])},t.prototype.elu=function(t){var e=new j.UnaryOpProgram(t.shape,W.ELU);return this.compileAndRun(e,[t])},t.prototype.eluDer=function(t,e){var n=new g.BinaryOpProgram(d.ELU_DER,t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.selu=function(t){var e=new j.UnaryOpProgram(t.shape,W.SELU);return this.compileAndRun(e,[t])},t.prototype.int=function(t){var e=new j.UnaryOpProgram(t.shape,W.TO_INT),n=this.makeOutputArray(e.outputShape,"int32");return this.compileAndRun(e,[t],n)},t.prototype.clip=function(t,e,n){var r=new y.ClipProgram(t.shape,e,n);return this.compileAndRun(r,[t])},t.prototype.abs=function(t){var e=new j.UnaryOpProgram(t.shape,W.ABS);return this.compileAndRun(e,[t])},t.prototype.sigmoid=function(t){var e=new j.UnaryOpProgram(t.shape,W.SIGMOID);return this.compileAndRun(e,[t])},t.prototype.softplus=function(t){var e=new j.UnaryOpProgram(t.shape,W.SOFTPLUS);return this.compileAndRun(e,[t])},t.prototype.sin=function(t){var e=new j.UnaryOpProgram(t.shape,W.SIN);return this.compileAndRun(e,[t])},t.prototype.cos=function(t){var e=new j.UnaryOpProgram(t.shape,W.COS);return this.compileAndRun(e,[t])},t.prototype.tan=function(t){var e=new j.UnaryOpProgram(t.shape,W.TAN);return this.compileAndRun(e,[t])},t.prototype.asin=function(t){var e=new j.UnaryOpProgram(t.shape,W.ASIN);return this.compileAndRun(e,[t])},t.prototype.acos=function(t){var e=new j.UnaryOpProgram(t.shape,W.ACOS);return this.compileAndRun(e,[t])},t.prototype.atan=function(t){var e=new j.UnaryOpProgram(t.shape,W.ATAN);return this.compileAndRun(e,[t])},t.prototype.atan2=function(t,e){var n=new g.BinaryOpProgram(d.ATAN2,t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.sinh=function(t){var e=new j.UnaryOpProgram(t.shape,W.SINH);return this.compileAndRun(e,[t])},t.prototype.cosh=function(t){var e=new j.UnaryOpProgram(t.shape,W.COSH);return this.compileAndRun(e,[t])},t.prototype.tanh=function(t){var e=new j.UnaryOpProgram(t.shape,W.TANH);return this.compileAndRun(e,[t])},t.prototype.asinh=function(t){var e=new j.UnaryOpProgram(t.shape,W.ASINH);return this.compileAndRun(e,[t])},t.prototype.acosh=function(t){var e=new j.UnaryOpProgram(t.shape,W.ACOSH);return this.compileAndRun(e,[t])},t.prototype.atanh=function(t){var e=new j.UnaryOpProgram(t.shape,W.ATANH);return this.compileAndRun(e,[t])},t.prototype.erf=function(t){var e=new j.UnaryOpProgram(t.shape,W.ERF);return this.compileAndRun(e,[t])},t.prototype.step=function(t,e){var n=new j.UnaryOpProgram(t.shape,W.STEP(e));return this.compileAndRun(n,[t])},t.prototype.conv2d=function(t,e,n){var r=new x.Conv2DProgram(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerInput=function(t,e,n){var r=new v.Conv2DDerInputProgram(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerFilter=function(t,e,n){var r=new v.Conv2DDerFilterProgram(n);return this.compileAndRun(r,[t,e])},t.prototype.depthwiseConv2D=function(t,e,n){var r=new T.DepthwiseConv2DProgram(n);return this.compileAndRun(r,[t,e])},t.prototype.maxPool=function(t,e){var n=new N.Pool2DProgram(e,"max",!1),r=this.makeOutputArray(n.outputShape,t.dtype);return this.compileAndRun(n,[t],r)},t.prototype.avgPool=function(t,e){var n=new N.Pool2DProgram(e,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.maxPoolBackprop=function(t,e,n,r){var o=new N.Pool2DProgram(r,"max",!0),a=this.compileAndRun(o,[e]),i=new S.MaxPool2DBackpropProgram(r),u=this.makeOutputArray(i.outputShape,e.dtype),s=this.compileAndRun(i,[t,a],u);return a.dispose(),s},t.prototype.avgPoolBackprop=function(t,e,n){var r=new f.AvgPool2DBackpropProgram(n),o=this.makeOutputArray(r.outputShape,e.dtype);return this.compileAndRun(r,[t],o)},t.prototype.cast=function(t,e){return l.castTensor(t,e,this)},t.prototype.reshape=function(t,e){return l.reshapeTensor(t,e)},t.prototype.resizeBilinear=function(t,e,n,r){var o=new k.ResizeBilinearProgram(t.shape,e,n,r);return this.compileAndRun(o,[t])},t.prototype.resizeNearestNeighbor=function(t,e,n,r){var o=new D.ResizeNearestNeighborProgram(t.shape,e,n,r);return this.compileAndRun(o,[t])},t.prototype.multinomial=function(t,e,n,r){var o=e?t:a.softmax(t),i=o.shape[0],u=o.shape[1],s=new O.MultinomialProgram(i,u,n),c=this.makeOutputArray(s.outputShape,"int32"),l=s.getCustomSetupFunc(r);return this.compileAndRun(s,[o],c,l)},t.prototype.oneHot=function(t,e,n,r){var o=new P.OneHotProgram(t.size,e,n,r);return this.compileAndRun(o,[t])},t.prototype.makeOutputArray=function(t,e){return u.Tensor.make(t,{},e)},t.prototype.compileAndRun=function(t,e,n,r){var o,a,i,u,s,c,l=this;return null==n&&(n=this.makeOutputArray(t.outputShape,e[0].dtype)),o=e.map((function(t){return l.uploadToGPU(t.dataId),{tensor:t,texData:l.texData.get(t.dataId)}})),this.uploadToGPU(n.dataId),a={tensor:n,texData:this.texData.get(n.dataId)},i=C.makeShaderKey(t,o,a),u=this.getAndSaveBinary(i,(function(){return C.compileProgram(l.gpgpu,t,o,a)})),(s=null!=this.activeTimers)&&(c=this.startTimer()),C.runProgram(u,o,a,r),s&&(c=this.endTimer(c),this.activeTimers.push(this.getQueryTime(c))),n},t.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){if(!this.disposed){for(var t in this.binaryCache)this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram);this.textureManager.dispose(),this.canvas.remove(),this.gpgpuCreatedLocally&&this.gpgpu.dispose(),this.disposed=!0}},t.prototype.throwIfNoData=function(t){if(!this.texData.has(t))throw Error("WebGL backend: No data found for this tensor. Did you change your backend in the middle of the program? New backends can't use Tensors created with previous backends")},t.prototype.uploadToGPU=function(t){var e,n,r,o,a,i,u,s,c,l;this.throwIfNoData(t),n=(e=this.texData.get(t)).shape,r=e.values,o=e.texture,e.dtype,a=e.texType,null==o&&((i=null!=this.activeTimers)&&(u=performance.now()),s=z.getTextureShapeFromLogicalShape(this.gpgpu.gl,n),e.texShape=s,c=this.textureManager.acquireTexture(s,a),e.texture=c,null!=r&&(this.gpgpu.uploadMatrixToTexture(c,s[0],s[1],(l=r)instanceof Float32Array?l:new Float32Array(l)),e.values=null,i&&(this.uploadWaitMs+=performance.now()-u)))},t.prototype.cacheOnCPU=function(t,e){var n=this.delayedStorage,r=this.texData.get(t),o=r.texture,a=r.texShape,i=r.dtype,u=r.texType;n&&null!=o&&(this.textureManager.releaseTexture(o,a,u),r.texture=null,r.texShape=null),null!=e&&(r.values=function(t,e){var n,r;if("float32"===e)return t;if("int32"===e||"bool"===e){for(n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw Error("Unknown dtype "+e)}(e,i))},t}(),e.MathBackendWebGL=X,r.ENV.registerBackend("webgl",(function(){return new X}),2)},2135:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isMobile=function(){var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}},2136:function(t,e,n){"use strict";var r,o,a,i,u,s,c,l,p=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{s(r.next(t))}catch(e){a(e)}}function u(t){try{s(r.throw(t))}catch(e){a(e)}}function s(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(i,u)}s((r=r.apply(t,e||[])).next())}))},f=this&&this.__generator||function(t,e){function n(n){return function(i){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!((a=(a=u.trys).length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(i){n=[6,i],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,i])}}var r,o,a,i,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(e,"__esModule",{value:!0}),r=n(632),o=n(679),a=n(656),i=n(2166),u=n(2167),s=n(712),c=n(630),l=function(){function t(t,e){this.backend=t,this.safeMode=e,this.registeredVariables={},this.refCounter=new WeakMap,this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numDataBuffers=0,this.gradientScopeCount=0,this.customGradientDepth=0,this.activeScope={keep:[],track:[]},this.scopeStack=[this.activeScope],this.profiler=new i.Profiler(t)}return t.prototype.runKernel=function(t,e,n){var o,a,i=this,u=[],s=function(t){return u.push(t),t},c=this.activeScope.name;return this.customGradientDepth++,o=r.ENV.get("DEBUG")?this.profiler.profileKernel(c,(function(){return t(i.backend,s)})):t(this.backend,s),this.customGradientDepth--,this.shouldRecord()&&(a={id:this.nextTapeNodeId++,name:c,inputs:e,output:o},null!=n&&(a.gradient=function(t){return n(t,u)}),this.activeTape.push(a)),o},t.prototype.registerTensor=function(t){var e=this.refCounter.has(t.dataId)?this.refCounter.get(t.dataId):0;this.numTensors++,0===e&&(this.numDataBuffers++,this.numBytes+=c.sizeFromShape(t.shape)*c.bytesPerElement(t.dtype),this.backend.register(t.dataId,t.shape,t.dtype)),this.refCounter.set(t.dataId,e+1),t instanceof s.Variable||this.track(t)},t.prototype.registerVariable=function(t){if(null!=this.registeredVariables[t.name])throw Error("Variable with name "+t.name+" was already registered");this.registeredVariables[t.name]=t},t.prototype.disposeTensor=function(t){if(this.refCounter.has(t.dataId)){this.numTensors--;var e=this.refCounter.get(t.dataId);e<=1?(this.refCounter.delete(t.dataId),this.backend.disposeData(t.dataId),this.numDataBuffers--,this.numBytes-=c.sizeFromShape(t.shape)*c.bytesPerElement(t.dtype)):this.refCounter.set(t.dataId,e-1)}},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.numTensors,t.numDataBuffers=this.numDataBuffers,t.numBytes=this.numBytes,t},t.prototype.shouldRecord=function(){return null!=this.activeTape&&0===this.customGradientDepth},t.prototype.addTapeNode=function(t,e,n){var r,o,a={};t.forEach((function(t,e){a[e]=t})),r=function(t){var e=n(t),r={};return e.forEach((function(t,e){r[e]=function(){return t}})),r},o={id:this.nextTapeNodeId++,name:this.activeScope.name,inputs:a,output:e,gradient:r},this.activeTape.push(o)},t.prototype.keep=function(t){if(1===this.scopeStack.length&&r.ENV.engine.safeMode)throw Error("Safe mode is ON. Enclose all tensor operations inside tf.tidy(): tf.tidy(() => {...}) to avoid memory leaks.");return this.activeScope.keep.push(t),t},t.prototype.startScope=function(t,e){void 0===e&&(e=!1),e&&0===this.gradientScopeCount&&(this.activeTape=[]),e&&this.gradientScopeCount++;var n={keep:[],track:[]};t&&(n.name=t),this.scopeStack.push(n),this.activeScope=n},t.prototype.endScope=function(t,e){var n,r,o,a,i=this;for(void 0===e&&(e=!1),e&&(this.gradientScopeCount--,0===this.gradientScopeCount&&(this.activeTape=null)),n=this.activeScope.keep,r=c.extractTensorsFromContainer(t),n=n.concat(r),o=0;o<this.activeScope.track.length;o++)a=this.activeScope.track[o],c.isTensorInList(a,n)||(null!=this.activeTape?r.push(a):a.dispose());this.scopeStack.pop(),this.activeScope=0===this.scopeStack.length?{keep:[],track:[]}:this.scopeStack[this.scopeStack.length-1],r.forEach((function(t){c.isTensorInList(t,i.activeScope.keep)||i.track(t)}))},t.prototype.dispose=function(){},t.prototype.gradients=function(t,e,n,r){var i=this;return void 0===r&&(r=!1),c.assert(e.length>0,"gradients() received an empty list of xs."),o.tidy("gradients",(function(){var o,l,p=t();if(c.assert(p instanceof s.Tensor,"The result y returned by f() must be a tensor."),o=u.getFilteredNodesXToY(i.activeTape,e,p),!r&&0===o.length&&e.length>0)throw Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return(l={})[p.id]=null==n?a.ones(p.shape):n,u.backpropagateGradients(l,o),{value:p,grads:e.map((function(t){return l[t.id]}))}}),!0)},t.prototype.customGrad=function(t){var e=this;return c.assert(c.isFunction(t),"The f passed in customGrad(f) must be a function."),function(){var n,r,a,i,u=[];for(n=0;n<arguments.length;n++)u[n]=arguments[n];return c.assert(u.every((function(t){return t instanceof s.Tensor})),"The args passed in customGrad(f)(x1, x2,...) must all be tensors"),e.customGradientDepth++,a=o.tidy(t.name,(function(){var e=t.apply(void 0,u),n=e.value,o=e.gradFunc;return c.assert(n instanceof s.Tensor,"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),c.assert(c.isFunction(o),"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r=o,n}),!0),e.customGradientDepth--,e.shouldRecord()&&(i=function(t){var e=r(t),n=Array.isArray(e)?e:[e];return c.assert(n.length===u.length,"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),c.assert(n.every((function(t){return t instanceof s.Tensor})),"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."),n},e.addTapeNode(u,a,i)),a}},t.prototype.write=function(t,e){this.backend.write(t,e)},t.prototype.readSync=function(t){return this.backend.readSync(t)},t.prototype.read=function(t){return this.backend.read(t)},t.prototype.fromPixels=function(t,e){return this.backend.fromPixels(t,e)},t.prototype.time=function(t){return p(this,void 0,void 0,(function(){var e,n;return f(this,(function(r){switch(r.label){case 0:return e=performance.now(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=performance.now()-e,[2,n]}}))}))},t.prototype.track=function(t){if(1===this.scopeStack.length&&this.safeMode)throw Error("Safe mode is ON. Enclose all tensor operations inside tf.tidy(): tf.tidy(() => {op();...}); to avoid memory leaks.");return this.activeScope.track.push(t),t},t}(),e.Engine=l},2137:function(t,e,n){"use strict";function r(t){if(t.filter((function(t){return null==t})).length>0)throw Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var o,a,i,u,s,c,l=this&&this.__decorate||function(t,e,n,r){var o,a,i=arguments.length,u=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(a=t.length-1;a>=0;a--)(o=t[a])&&(u=(i<3?o(u):i>3?o(e,n,u):o(e,n))||u);return i>3&&u&&Object.defineProperty(e,n,u),u};Object.defineProperty(e,"__esModule",{value:!0}),o=n(638),a=n(632),i=n(679),u=n(712),s=n(630),c=function(){function t(){}return t.gradScope=function(t,e){return i.tidy(t,e,!0)},t.grad=function(t){return s.assert(s.isFunction(t),"The f passed in grad(f) must be a function"),function(e,n){s.assert(e instanceof u.Tensor,"The x passed in grad(f)(x) must be a tensor"),s.assert(null==n||n instanceof u.Tensor,"The dy passed in grad(f)(x, dy) must be a tensor");var o=a.ENV.engine.gradients((function(){return t(e)}),[e],n),i=o.value,c=o.grads;return null!=n&&s.assertShapesMatch(i.shape,n.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),i.dispose(),r(c),c[0]}},t.grads=function(t){return s.assert(s.isFunction(t),"The f passed in grads(f) must be a function"),function(e,n){s.assert(Array.isArray(e)&&e.every((function(t){return t instanceof u.Tensor})),"The args passed in grads(f)(args) must be an array of tensors"),s.assert(null==n||n instanceof u.Tensor,"The dy passed in grads(f)(args, dy) must be a tensor");var o=a.ENV.engine.gradients((function(){return t.apply(void 0,e)}),e,n),i=o.value,c=o.grads;return null!=n&&s.assertShapesMatch(i.shape,n.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),i.dispose(),r(c),c}},t.valueAndGrad=function(t){return s.assert(s.isFunction(t),"The f passed in valueAndGrad(f) must be a function"),function(e,n){s.assert(e instanceof u.Tensor,"The x passed in valueAndGrad(f)(x) must be a tensor"),s.assert(null==n||n instanceof u.Tensor,"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");var o=a.ENV.engine.gradients((function(){return t(e)}),[e],n),i=o.grads,c=o.value;return r(i),{grad:i[0],value:c}}},t.valueAndGrads=function(t){return s.assert(s.isFunction(t),"The f passed in valueAndGrads(f) must be a function"),function(e,n){s.assert(Array.isArray(e)&&e.every((function(t){return t instanceof u.Tensor})),"The args passed in valueAndGrads(f)(args) must be array of tensors"),s.assert(null==n||n instanceof u.Tensor,"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");var o=a.ENV.engine.gradients((function(){return t.apply(void 0,e)}),e,n);return null!=n&&s.assertShapesMatch(o.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),r(o.grads),o}},t.variableGrads=function(t,e){var n,r,o,i,c,l;if(s.assert(s.isFunction(t),"The f passed in variableGrads(f) must be a function"),s.assert(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof u.Variable})),"The varList passed in variableGrads(f, varList) must be an array of variables"),null==e)for(n in e=[],a.ENV.engine.registeredVariables)e.push(a.ENV.engine.registeredVariables[n]);return r=e.length,e=e.filter((function(t){return t.trainable})),s.assert(e.length>0,"variableGrads() expects at least one of the input variables to be trainable, but none of the "+r+" variables is trainable."),i=(o=a.ENV.engine.gradients(t,e,null,!0)).value,c=o.grads,s.assert(c.some((function(t){return null!=t})),"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),s.assert(0===i.rank,"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+i.rank+" tensor"),l={},e.forEach((function(t,e){null!=c[e]&&(l[t.name]=c[e])})),{value:i,grads:l}},t.customGrad=function(t){return a.ENV.engine.customGrad(t)},l([o.doc({heading:"Training",subheading:"Gradients"})],t,"grad",null),l([o.doc({heading:"Training",subheading:"Gradients"})],t,"grads",null),l([o.doc({heading:"Training",subheading:"Gradients"})],t,"valueAndGrad",null),l([o.doc({heading:"Training",subheading:"Gradients"})],t,"valueAndGrads",null),l([o.doc({heading:"Training",subheading:"Gradients"})],t,"variableGrads",null),l([o.doc({heading:"Training",subheading:"Gradients"})],t,"customGrad",null),t}(),e.Gradients=c},2169:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ArgMinMaxProgram=function(t,e,n){var r,o,a,i,u,s;this.variableNames=["A"],r=t.windowSize,o=t.batchSize,a=t.inSize,i=Math.ceil(a/r),n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i],u="max"===e?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));",this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = 0;\n        float bestValue = getA(batch, inOffset);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+s+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+u+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "}},2170:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AvgPool2DBackpropProgram=function(t){var e,n,r,o,a,i,u;this.variableNames=["dy"],this.outputShape=t.inShape,e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,a=e-1-t.padInfo.top,i=n-1-t.padInfo.left,u=1/(e*n),this.userCode="\n      const ivec2 pads = ivec2("+a+", "+i+");\n      const float avgMultiplier = float("+u+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}},2171:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=n(731),o=function(t,e,n,o,a,i){var u,s;this.outputShape=[],this.supportsBroadcasting=!0,this.variableNames=["x","mean","variance"],r.assertAndGetBroadcastShape(t,e),r.assertAndGetBroadcastShape(t,n),u="0.0",null!=o&&(r.assertAndGetBroadcastShape(t,o),this.variableNames.push("offset"),u="getOffsetAtOutCoords()"),s="1.0",null!=a&&(r.assertAndGetBroadcastShape(t,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+u+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput((x - mean) * inv + offset);\n      }\n    "},e.BatchNormProgram=o},2172:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ClipProgram=function(t,e,n){var r,o;this.variableNames=["A"],this.outputShape=t,r=e.toFixed(20),o=n.toFixed(20),this.userCode="\n      void main() {\n        float value = getAAtOutCoords();\n        if (isNaN(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, "+r+", "+o+"));\n      }\n    "}},2173:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=n(1038),o=function(t,e){this.variableNames=["A","B"],this.outputShape=[],this.outputShape=r.computeOutShape(t,e,1),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        float value = 0.0;\n        if (yC < "+t[1]+") {\n          value = getA(yR, yC);\n        } else {\n          yC -= "+t[1]+";\n          value = getB(yR, yC);\n        }\n\n        setOutput(value);\n      }\n    "},e.ConcatProgram=o},2174:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=function(t){var e,n,r,o;this.variableNames=["x","dy"],this.outputShape=t.filterShape,e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,o=t.padInfo.left,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+e+" - "+r+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+o+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},e.Conv2DDerFilterProgram=r,o=function(t){var e,n,r,o,a,i;this.variableNames=["dy","W"],this.outputShape=t.inShape,e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,a=e-1-t.padInfo.top,i=n-1-t.padInfo.left,this.userCode="\n      const ivec2 pads = ivec2("+a+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, d2);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},e.Conv2DDerInputProgram=o},2175:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Conv2DProgram=function(t){var e,n,r,o,a,i,u,s,c,l;this.variableNames=["x","W"],this.outputShape=t.outShape,e=t.padInfo.top,n=t.padInfo.left,r=t.strideHeight,o=t.strideWidth,a=t.dilationHeight,i=t.dilationWidth,u=t.filterHeight,s=t.filterWidth,c=4*Math.floor(t.inChannels/4),l=t.inChannels%4,this.userCode="\n      const ivec2 strides = ivec2("+r+", "+o+");\n      const ivec2 pads = ivec2("+e+", "+n+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+u+"; wR++) {\n          int xR = xRCorner + wR * "+a+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+s+"; wC++) {\n            int xC = xCCorner + wC * "+i+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+c+"; d1 += 4) {\n              vec4 xValues = vec4(\n                getX(batch, xR, xC, d1),\n                getX(batch, xR, xC, d1 + 1),\n                getX(batch, xR, xC, d1 + 2),\n                getX(batch, xR, xC, d1 + 3)\n              );\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              dotProd += dot(xValues, wValues);\n            }\n\n            if ("+(1===l)+") {\n              dotProd +=\n                getX(batch, xR, xC, "+c+") *\n                getW(wR, wC, "+c+", d2);\n            } else if ("+(2===l)+") {\n              vec2 xValues = vec2(\n                getX(batch, xR, xC, "+c+"),\n                getX(batch, xR, xC, "+c+" + 1)\n              );\n              vec2 wValues = vec2(\n                getW(wR, wC, "+c+", d2),\n                getW(wR, wC, "+c+" + 1, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            } else if ("+(3===l)+") {\n              vec3 xValues = vec3(\n                getX(batch, xR, xC, "+c+"),\n                getX(batch, xR, xC, "+c+" + 1),\n                getX(batch, xR, xC, "+c+" + 2)\n              );\n              vec3 wValues = vec3(\n                getW(wR, wC, "+c+", d2),\n                getW(wR, wC, "+c+" + 1, d2),\n                getW(wR, wC, "+c+" + 2, d2)\n              );\n              dotProd += dot(xValues, wValues);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}},2176:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DepthwiseConv2DProgram=function(t){var e,n,r,o,a,i,u,s,c,l,p;this.variableNames=["x","W"],this.outputShape=t.outShape,e=t.inHeight,n=t.inWidth,r=t.padInfo.top,o=t.padInfo.left,a=t.strideHeight,i=t.strideWidth,u=t.dilationHeight,s=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,p=t.outChannels/t.inChannels,this.userCode="\n      const ivec2 strides = ivec2("+a+", "+i+");\n      const ivec2 pads = ivec2("+r+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+p+";\n        int q = d2 - d1 * "+p+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TODO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+c+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+e+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+l+"; wC++) {\n            int xC = xCCorner + wC * "+s+";\n\n            if (xC < 0 || xC >= "+n+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}},2177:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FromPixelsProgram=function(t){this.variableNames=["A"];var e=t[0],n=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+n+".0, "+e+".0);\n\n        vec4 values = texture2D(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "}},2178:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=n(732),o=function(t,e,n){var o,a,i;this.variableNames=["A","indices"],(o=t.slice())[n]=e,this.outputShape=o,this.rank=o.length,a=r.getCoordsDataType(this.rank),i=function(t,e){var n,r,o,a=t.length;if(a>4)throw Error("Gather for rank "+a+" is not yet supported");if(1===a)return"int(getIndices(resRC))";for(n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],o=0;o<t.length;o++)o===e?r.push("int(getIndices("+n[o]+"))"):r.push(""+n[o]);return r.join()}(t,n),this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},e.GatherProgram=o},2179:function(t,e,n){"use strict";var r,o,a,i,u,s,c=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{s(r.next(t))}catch(e){a(e)}}function u(t){try{s(r.throw(t))}catch(e){a(e)}}function s(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(i,u)}s((r=r.apply(t,e||[])).next())}))},l=this&&this.__generator||function(t,e){function n(n){return function(i){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!((a=(a=u.trys).length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(i){n=[6,i],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,i])}}var r,o,a,i,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(e,"__esModule",{value:!0}),r=n(632),o=n(630),a=n(1262),i=n(829),u=n(900),s=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.autoDebugValidate=!1,this.vertexAttrsAreBound=!1,this.gl=null!=t?t:a.createWebGLContext(),1===r.ENV.get("WEBGL_VERSION")?(this.textureFloatExtension=u.getExtensionOrThrow(this.gl,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float")):this.colorBufferFloatExtension=u.getExtensionOrThrow(this.gl,"EXT_color_buffer_float"),this.loseContextExtension=u.getExtensionOrThrow(this.gl,"WEBGL_lose_context"),r.ENV.get("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED")&&(this.getBufferSubDataAsyncExtension=this.gl.getExtension("WEBGL_get_buffer_sub_data_async")),this.vertexBuffer=a.createVertexBuffer(this.gl),this.indexBuffer=a.createIndexBuffer(this.gl),this.framebuffer=u.createFramebuffer(this.gl)}return t.prototype.dispose=function(){var t,e=this;this.disposed||(null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing."),t=this.gl,u.callAndCheck(t,(function(){return t.finish()})),u.callAndCheck(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),u.callAndCheck(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),u.callAndCheck(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),u.callAndCheck(t,(function(){return t.deleteBuffer(e.vertexBuffer)})),u.callAndCheck(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),u.callAndCheck(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.loseContextExtension.loseContext(),this.disposed=!0)},t.prototype.enableAutomaticDebugValidation=function(t){this.autoDebugValidate=t,u.enableDebugWebGLErrorChecking(t)},t.prototype.createMatrixTexture=function(t,e){return this.throwIfDisposed(),a.createMatrixTexture(this.gl,t,e)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),a.uploadPixelDataToTexture(this.gl,t,e)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),a.createPackedMatrixTexture(this.gl,t,e)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(u.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer),this.outputTexture=null),u.callAndCheck(this.gl,(function(){return e.gl.deleteTexture(t)}))},t.prototype.uploadMatrixToTexture=function(t,e,n,r){return this.throwIfDisposed(),a.uploadMatrixToTexture(this.gl,t,e,n,r,1)},t.prototype.uploadMatrixToPackedTexture=function(t,e,n,r){return this.throwIfDisposed(),a.uploadMatrixToPackedTexture(this.gl,t,e,n,r)},t.prototype.downloadMatrixFromTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return a.downloadMatrixFromOutputTexture(r.gl,e,n)}))},t.prototype.downloadMatrixFromTextureAsync=function(t,e,n){return c(this,void 0,void 0,(function(){var r=this;return l(this,(function(o){if(null==this.getBufferSubDataAsyncExtension)throw Error("Cannot download matrix from output texture asynchronously, WEBGL_get_buffer_sub_data_async is not enabled.");return[2,this.downloadMatrixDriverAsync(t,(function(){return a.downloadMatrixFromOutputTextureAsync(r.gl,r.getBufferSubDataAsyncExtension,e,n)}))]}))}))},t.prototype.downloadMatrixFromRGBAColorTexture=function(t,e,n,r){var o=this;return this.downloadMatrixDriver(t,(function(){return a.downloadMatrixFromRGBAColorTexture(o.gl,e,n,r)}))},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return a.downloadMatrixFromPackedOutputTexture(r.gl,e,n)}))},t.prototype.createProgram=function(t){var e,n,r,o;return this.throwIfDisposed(),e=this.gl,n=u.createFragmentShader(e,t),r=a.createVertexShader(e),o=u.createProgram(e),u.callAndCheck(e,(function(){return e.attachShader(o,r)})),u.callAndCheck(e,(function(){return e.attachShader(o,n)})),u.linkProgram(e,o),this.autoDebugValidate&&u.validateProgram(e,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=a.bindVertexProgramAttributeStreams(e,this.program,this.vertexBuffer)),o},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&u.callAndCheck(this.gl,(function(){return e.gl.deleteProgram(t)}))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.autoDebugValidate&&u.validateProgram(this.gl,this.program),u.callAndCheck(this.gl,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?u.getProgramUniformLocationOrThrow(this.gl,t,e):u.getProgramUniformLocation(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),u.callAndCheck(this.gl,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),u.bindTextureToProgramUniformSampler(this.gl,this.program,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=i.getPackedMatrixTextureShapeWidthHeight(e,n),o=r[0],a=r[1];this.setOutputMatrixTextureDriver(t,o,a)},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&u.validateProgram(this.gl,this.program),u.validateFramebuffer(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.autoDebugValidate&&this.debugValidate(),u.callAndCheck(t,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),u.callAndCheck(this.gl,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=u.getExtensionOrThrow(this.gl,2===r.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.runQuery=function(t){var e=this.beginQuery();return t(),this.endQuery(),this.pollQueryTime(e)},t.prototype.beginQuery=function(){var t,e,n,o,a;return 2===r.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?(t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery(),t.beginQuery(e.TIME_ELAPSED_EXT,n),n):(a=(o=this.getQueryTimerExtensionWebGL1()).createQueryEXT(),o.beginQueryEXT(o.TIME_ELAPSED_EXT,a),a)},t.prototype.endQuery=function(){var t,e,n;if(2===r.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))return t=this.gl,e=this.getQueryTimerExtensionWebGL2(),void t.endQuery(e.TIME_ELAPSED_EXT);(n=this.getQueryTimerExtensionWebGL1()).endQueryEXT(n.TIME_ELAPSED_EXT)},t.prototype.isQueryAvailable=function(t,e){var n,r,o,a;return 0===e||(2===e?(n=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE),a=this.gl.getParameter(r.GPU_DISJOINT_EXT),o&&!a):(o=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),a=this.gl.getParameter(r.GPU_DISJOINT_EXT),o&&!a))},t.prototype.pollQueryTime=function(t){var e=this;return new Promise((function(n,a){var i=r.ENV.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION");o.repeatedTry((function(){return e.isQueryAvailable(t,i)})).then((function(){return n(e.getQueryTime(t,i))})).catch((function(){console.warn("Disjoint query timer never available."),n(-1)}))}))},t.prototype.getQueryTime=function(t,e){var n,r;return 0===e?null:2===e?(n=this.gl).getQueryParameter(t,n.QUERY_RESULT)/1e6:(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.downloadMatrixDriverSetup=function(t){this.throwIfDisposed(),u.bindColorTextureToFramebuffer(this.gl,t,this.framebuffer),this.autoDebugValidate&&u.validateFramebuffer(this.gl)},t.prototype.downloadMatrixDriverTeardown=function(){null!=this.outputTexture?(u.bindColorTextureToFramebuffer(this.gl,this.outputTexture,this.framebuffer),this.autoDebugValidate&&u.validateFramebuffer(this.gl)):u.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.downloadMatrixDriverSetup(t);var n=e();return this.downloadMatrixDriverTeardown(),n},t.prototype.downloadMatrixDriverAsync=function(t,e){return c(this,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return this.downloadMatrixDriverSetup(t),[4,e()];case 1:return n=r.sent(),this.downloadMatrixDriverTeardown(),[2,n]}}))}))},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;u.bindColorTextureToFramebuffer(r,t,this.framebuffer),this.autoDebugValidate&&u.validateFramebuffer(r),this.outputTexture=t,u.callAndCheck(r,(function(){return r.viewport(0,0,e,n)})),u.callAndCheck(r,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var o=this;this.throwIfDisposed(),u.callAndCheck(this.gl,(function(){return o.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw Error("No GPU program is currently set.")},t}(),e.GPGPUContext=s},2180:function(t,e,n){"use strict";function r(){return!a.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")}function o(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach((function(t,n){var r=t.logicalShape,o=t.texShape,a=e[n].tensor.shape,u=e[n].texData.texShape;if(!i.arraysEqual(r,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+a+" must match");if(!i.arraysEqual(o,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+o+" and "+u+" must match")}))}var a,i,u,s;Object.defineProperty(e,"__esModule",{value:!0}),a=n(632),i=n(630),u=n(732),s="NaN",e.compileProgram=function(t,e,n,o){var a,i,c=e.userCode,l=n.map((function(t,n){var r={logicalShape:t.tensor.shape,texShape:t.texData.texShape};return{name:e.variableNames[n],shapeInfo:r}})),p=l.map((function(t){return t.shapeInfo})),f={logicalShape:o.tensor.shape,texShape:o.texData.texShape},h=u.makeShader(l,f,c,!0===e.supportsBroadcasting),d=t.createProgram(h),g={};for(a=0;a<e.variableNames.length;a++)g[i=e.variableNames[a]]=t.getUniformLocation(d,i);return r()&&(g[s]=t.getUniformLocation(d,s,!1)),{program:e,source:h,webGLProgram:d,uniformLocations:g,gpgpu:t,inShapeInfos:p,outShapeInfo:f}},e.runProgram=function(t,e,n,a){var i,u,c;o(t.inShapeInfos,e),o([t.outShapeInfo],[n]),i=n.texData.texture,u=n.texData.texShape,(c=t.gpgpu).setOutputMatrixTexture(i,u[0],u[1]),c.setProgram(t.webGLProgram),e.forEach((function(e,n){var r=e.texData.texture,o=t.program.variableNames[n],a=t.uniformLocations[o];c.setInputMatrixTexture(r,a,n)})),r()&&c.gl.uniform1f(t.uniformLocations[s],NaN),null!=a&&a(c,t.webGLProgram),c.executeProgram()},e.makeShaderKey=function(t,e,n){var r,o,a="";return e.concat(n).forEach((function(t){a+=t.tensor.shape+"_"+t.texData.texShape})),r=t.userCode,o=""+(!0===t.supportsBroadcasting),t.constructor.name+"_"+o+"_"+a+"_"+r}},2181:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=n(732),o=function(t,e,n){var o,a,i,u,s,c,l;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)a="resRC",o="resRC";else{for(i=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],s=[],c=0;c<e.length;c++)s.push(""+i[c]),c<t&&u.push(""+i[c]);o=u.join(),a=s.join()}l=r.getCoordsDataType(n),this.userCode="\n      void main() {\n        "+l+" resRC = getOutputCoords();\n        float cVal = getC("+o+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+a+"));\n        } else {\n          setOutput(getB("+a+"));\n        }\n      }\n    "},e.WhereProgram=o},2182:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LRNProgram=function(t,e,n,r,o){var a,i,u,s;this.variableNames=["x"],this.outputShape=[],a=e,i=t[3]-1,this.outputShape=t,s="float("+n+") + float("+r+") * sum",u=.5===o?"inversesqrt("+s+")":1===o?"1.0/("+s+")":"exp(log("+s+") * float(-"+o+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+a+"; j <= "+a+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+i+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+u+";\n        setOutput(val);\n      }\n    "}},2183:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MaxPool2DBackpropProgram=function(t){var e,n,r,o,a,i,u;this.variableNames=["dy","maxPos"],this.outputShape=t.inShape,e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,o=t.strideWidth,a=e-1-t.padInfo.top,i=n-1-t.padInfo.left,u=e*n-1,this.userCode="\n      const ivec2 pads = ivec2("+a+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+n+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "}},2184:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MatMulProgram=function(t,e,n,r){var o,a,i,u,s,c,l;void 0===n&&(n=!1),void 0===r&&(r=!1),this.variableNames=["matrixA","matrixB"],o=n?t[1]:t[0],a=r?e[0]:e[1],i=n?t[0]:t[1],this.outputShape=[o,a],u=function(t,e){return n?e+" + "+t+", aRow":"aRow, "+e+" + "+t},s=function(t,e){return r?"bCol, "+e+" + "+t:e+" + "+t+", bCol"},c=4*Math.floor(i/4),l=i%4,this.userCode=" float dotARowBCol(int aRow, int bCol) {\n      float result = 0.0;\n      for (int i = 0; i < "+c+"; i += 4) {\n        vec4 a = vec4(\n          getMatrixA("+u(0,"i")+"),\n          getMatrixA("+u(1,"i")+"),\n          getMatrixA("+u(2,"i")+"),\n          getMatrixA("+u(3,"i")+")\n        );\n        vec4 b = vec4(\n          getMatrixB("+s(0,"i")+"),\n          getMatrixB("+s(1,"i")+"),\n          getMatrixB("+s(2,"i")+"),\n          getMatrixB("+s(3,"i")+")\n        );\n\n        result += dot(a, b);\n      }\n\n      if ("+(1===l)+") {\n        result += getMatrixA("+u(0,c)+") *\n          getMatrixB("+s(0,c)+");\n      } else if ("+(2===l)+") {\n        vec2 a = vec2(\n          getMatrixA("+u(0,c)+"),\n          getMatrixA("+u(1,c)+")\n        );\n        vec2 b = vec2(\n          getMatrixB("+s(0,c)+"),\n          getMatrixB("+s(1,c)+")\n        );\n        result += dot(a, b);\n      } else if ("+(3===l)+") {\n        vec3 a = vec3(\n          getMatrixA("+u(0,c)+"),\n          getMatrixA("+u(1,c)+"),\n          getMatrixA("+u(2,c)+")\n        );\n        vec3 b = vec3(\n          getMatrixB("+s(0,c)+"),\n          getMatrixB("+s(1,c)+"),\n          getMatrixB("+s(2,c)+")\n        );\n        result += dot(a, b);\n      }\n\n      return result;\n    }\n\n    void main() {\n      ivec2 resRC = getOutputCoords();\n      setOutput(dotARowBCol(resRC.x, resRC.y));\n    }\n    "}},2185:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}},t}();e.MultinomialProgram=r},2186:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OneHotProgram=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "}},2187:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=n(732),o=function(t,e,n){var o,a,i,u,s;this.variableNames=["x"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]})),o=t.length,a=r.getCoordsDataType(o),i=e.map((function(t){return t[0]})).join(","),u=e.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,o),this.userCode=1!==o?"\n      "+a+" start = "+a+"("+i+");\n      "+a+" end = "+a+"("+u+");\n\n      void main() {\n        "+a+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+a+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+u+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},e.PadProgram=o},2188:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Pool2DProgram=function(t,e,n){var r,o,a,i,u,s,c,l,p,f,h,d;if(this.variableNames=["x"],"avg"===e&&n)throw Error("Cannot compute positions for average pool.");r=t.filterHeight,o=t.filterWidth,a=t.strideHeight,i=t.strideWidth,u=t.padInfo.top,s=t.padInfo.left,this.outputShape=t.outShape,l="0.0",(c="avg"===e)||(l="-1.0 / 0.0"),n?this.userCode="\n        const ivec2 strides = ivec2("+a+", "+i+");\n        const ivec2 pads = ivec2("+u+", "+s+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+r+"; wR++) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+o+"; wC++) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+o+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ":(p=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])","avg"===e&&(p="avgValue / count"),f=4*Math.floor(o/4),h=o%4,d="\n      if ("+c+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ",this.userCode="\n      const ivec2 strides = ivec2("+a+", "+i+");\n      const ivec2 pads = ivec2("+u+", "+s+");\n      const float initializationValue = "+l+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+l+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+r+"; wR++) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+f+"; wC += 4) {\n            int xC = xCCorner + wC;\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              getValue(batch, xR, xC + 2, d),\n              getValue(batch, xR, xC + 3, d)\n            );\n\n            "+d+"\n          }\n\n          int xC = xCCorner + "+f+";\n          if ("+(1===h)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+d+"\n          } else if ("+(2===h)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+d+"\n          } else if ("+(3===h)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + 1, d),\n              getValue(batch, xR, xC + 2, d),\n              initializationValue\n            );\n\n            "+d+"\n          }\n        }\n        setOutput("+p+");\n      }\n    ")}},2189:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ReduceProgram=function(t,e){var n,r,o,a,i,u,s,c,l,p,f,h;this.variableNames=["x"],n=t.windowSize,r=t.batchSize,o=t.inSize,a=Math.ceil(o/n),this.outputShape=[r,a],u="0.0",(i="sum"===e)||(u="min"===e?"1.0 / 0.0":"-1.0 / 0.0"),s="min"===e?"min":"max",c=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])","sum"===e&&(c="sumValue"),l=4*Math.floor(n/4),p=n%4,f="\n      if ("+i+") {\n        sumValue += dot(values, ones);\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",h="",o%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+u+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+h+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+u+");\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+l+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+f+"\n        }\n\n        int inIdx = inOffset + "+l+";\n        if ("+(1===p)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n          "+f+"\n        } else if ("+(2===p)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n          "+f+"\n        } else if ("+(3===p)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n          "+f+"\n        }\n        setOutput("+c+");\n      }\n    "}},2190:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ResizeBilinearProgram=function(t,e,n,r){var o,a,i,u,s,c;this.variableNames=["A"],this.outputShape=[],o=t[0],a=t[1],i=t[2],u=t[3],this.outputShape=[o,e,n,u],s=r?[a-1,i-1]:[a,i],c=r?[e-1,n-1]:[e,n],this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+s[0]/c[0]+",\n          "+s[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+a+".0, "+i+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "}},2191:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ResizeNearestNeighborProgram=function(t,e,n,r){var o,a,i,u,s,c;this.variableNames=["A"],this.outputShape=[],o=t[0],a=t[1],i=t[2],u=t[3],this.outputShape=[o,e,n,u],s=r?[a-1,i-1]:[a,i],c=r?[e-1,n-1]:[e,n],this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+s[0]/c[0]+",\n          "+s[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+a+".0, "+i+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + 0.5)));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "}},2192:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=n(732),o=function(t,e){var n,o,a,i;if(this.variableNames=["x"],(n=t.length)>4)throw Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t,1!==n?(o=function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - coords["+n+"] - 1":"coords["+n+"]"},a=t.map((function(t,e){return o(e)})).join(","),i=r.getCoordsDataType(n),this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+a+"));\n      }\n    "):this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},e.ReverseProgram=o},2193:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=n(732),o=function(){function t(t){var e,n;this.variableNames=["source"],this.outputShape=t,this.rank=t.length,e=r.getCoordsDataType(this.rank),n=function(t){if(1===t)return"sourceLoc";if(2===t)return"sourceLoc.x, sourceLoc.y";if(3===t)return"sourceLoc.x, sourceLoc.y, sourceLoc.z";if(4===t)return"sourceLoc.x, sourceLoc.y, sourceLoc.z, sourceLoc.w";throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank),this.userCode="\n      uniform "+e+" start;\n\n      void main() {\n        "+e+" sourceLoc = start + getOutputCoords();\n        setOutput(getSource("+n+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){if(null!=e.startLoc||(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null!=e.startLoc))if(1===e.rank)n.gl.uniform1i(e.startLoc,t[0]);else if(2===e.rank)n.gl.uniform2i(e.startLoc,t[0],t[1]);else if(3===e.rank)n.gl.uniform3i(e.startLoc,t[0],t[1],t[2]);else{if(4!==e.rank)throw Error("Slicing for rank "+e.rank+" is not yet supported");n.gl.uniform4i(e.startLoc,t[0],t[1],t[2],t[3])}}},t}(),e.SliceProgram=o},2194:function(t,e,n){"use strict";function r(t,e){return t[0]+"_"+t[1]+"_"+e}var o,a;Object.defineProperty(e,"__esModule",{value:!0}),o=n(829),a=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.allocatedTextures=[],this.usedTextureCount={}}return t.prototype.acquireTexture=function(t,e){var n,a;return void 0===e&&(e=o.TextureType.FLOAT),(n=r(t,e))in this.freeTextures||(this.freeTextures[n]=[]),n in this.usedTextureCount||(this.usedTextureCount[n]=0),this.usedTextureCount[n]++,this.freeTextures[n].length>0?(this.numFreeTextures--,this.numUsedTextures++,this.log(),this.freeTextures[n].shift()):(this.numUsedTextures++,this.log(),a=this.gpgpu.createMatrixTexture(t[0],t[1]),this.allocatedTextures.push(a),a)},t.prototype.releaseTexture=function(t,e,n){void 0===n&&(n=o.TextureType.FLOAT);var a=r(e,n);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(t),this.numFreeTextures++,this.numUsedTextures--,this.usedTextureCount[a]--,this.log()},t.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;null!=this.allocatedTextures&&(this.allocatedTextures.forEach((function(e){t.gpgpu.deleteMatrixTexture(e)})),this.freeTextures=null,this.allocatedTextures=null,this.usedTextureCount=null,this.numUsedTextures=0,this.numFreeTextures=0)},t}(),e.TextureManager=a},2195:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=n(732),o=function(t,e){var n,o,a,i;for(this.variableNames=["A"],n=Array(t.length),o=0;o<n.length;o++)n[o]=t[o]*e[o];this.outputShape=n,this.rank=n.length,a=r.getCoordsDataType(this.rank),i=function(t){var e,n,r,o=t.length;if(o>4)throw Error("Tile for rank "+o+" is not yet supported");if(1===o)return"imod(resRC, "+t[0]+")";for(e=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[],r=0;r<t.length;r++)n.push("imod("+e[r]+", "+t[r]+")");return n.join()}(t),this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},e.TileProgram=o},2196:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=n(732),o=function(t,e){var n,o,a,i;for(this.variableNames=["A"],n=Array(t.length),o=0;o<n.length;o++)n[o]=t[e[o]];this.outputShape=n,this.rank=n.length,a=r.getCoordsDataType(this.rank),i=function(t){var e,n,r,o=t.length;if(o>4)throw Error("Transpose for rank "+o+" is not yet supported");for(e=["resRC.x","resRC.y","resRC.z","resRC.w"],n=Array(o),r=0;r<t.length;r++)n[t[r]]=e[r];return n.join()}(e),this.userCode="\n    void main() {\n      "+a+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},e.TransposeProgram=o},2197:function(t,e,n){"use strict";var r,o,a,i,u,s,c,l,p,f,h,d,g,y,m=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{s(r.next(t))}catch(e){a(e)}}function u(t){try{s(r.throw(t))}catch(e){a(e)}}function s(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(i,u)}s((r=r.apply(t,e||[])).next())}))},v=this&&this.__generator||function(t,e){function n(n){return function(i){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!((a=(a=u.trys).length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(i){n=[6,i],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,i])}}var r,o,a,i,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(e,"__esModule",{value:!0}),r=n(1256),o=n(632),a=n(713),i=n(731),u=n(1038),s=n(656),c=n(656),l=n(1039),p=n(1264),f=n(712),h=n(756),d=n(630),g=n(1260),y=function(){function t(){this.data=new WeakMap,"undefined"!=typeof document&&(this.canvas=document.createElement("canvas"))}return t.prototype.register=function(t,e,n){if(this.data.has(t))throw Error("Data buffer is already registered");this.data.set(t,null)},t.prototype.write=function(t,e){if(null==e)throw Error("MathBackendCPU.write(): values can not be null");this.throwIfNoData(t),this.data.set(t,e)},t.prototype.fromPixels=function(t,e){var n,r,o,a,i,u;if(null==t)throw Error("MathBackendCPU.writePixels(): pixels can not be null");if(t instanceof ImageData)n=t.data;else if(t instanceof HTMLCanvasElement)n=t.getContext("2d").getImageData(0,0,t.width,t.height).data;else{if(!(t instanceof HTMLImageElement||t instanceof HTMLVideoElement))throw Error("pixels is of unknown type: "+t.constructor.name);if(null==this.canvas)throw Error("Can't read pixels from HTMLImageElement outside the browser.");this.canvas.width=t.width,this.canvas.height=t.height,this.canvas.getContext("2d").drawImage(t,0,0,t.width,t.height),n=this.canvas.getContext("2d").getImageData(0,0,t.width,t.height).data}if(4===e)r=new Int32Array(n);else for(o=t.width*t.height,r=new Int32Array(o*e),a=0;a<o;a++)for(i=0;i<e;++i)r[a*e+i]=n[4*a+i];return u=[t.height,t.width,e],c.tensor3d(r,u,"int32")},t.prototype.read=function(t){return m(this,void 0,void 0,(function(){return v(this,(function(e){return[2,this.readSync(t)]}))}))},t.prototype.readSync=function(t){return this.throwIfNoData(t),this.data.get(t)},t.prototype.disposeData=function(t){this.data.has(t)&&this.data.delete(t)},t.prototype.time=function(t){return m(this,void 0,void 0,(function(){var e;return v(this,(function(n){return e=performance.now(),t(),[2,{kernelMs:performance.now()-e}]}))}))},t.prototype.memory=function(){return{unreliable:!0}},t.prototype.throwIfNoData=function(t){if(!this.data.has(t))throw Error("CPU backend: No data found for this tensor. Did you change your backend in the middle of the program? New backends can't use Tensors created with previous backends")},t.prototype.slice=function(t,e,n){var r,o,a,i=s.buffer(n,t.dtype);for(r=0;r<i.size;++r)a=(o=i.indexToLoc(r)).map((function(t,n){return t+e[n]})),i.set.apply(i,[t.get.apply(t,a)].concat(o));return i.toTensor()},t.prototype.reverse=function(t,e){var n,r=s.buffer(t.shape,t.dtype),o=t.buffer(),a=function(n){var a=r.indexToLoc(n),i=a.slice();e.forEach((function(e){return i[e]=t.shape[e]-1-i[e]})),r.set.apply(r,[o.get.apply(o,i)].concat(a))};for(n=0;n<r.size;n++)a(n);return r.toTensor()},t.prototype.concat=function(t,e){var n,r,o,a,i,c=u.computeOutShape(t.shape,e.shape,1),l=s.buffer(c,t.dtype);if(1===t.shape[0]&&1===e.shape[0])return n=t.dataSync(),r=e.dataSync(),(o=l.values).set(n,0),o.set(r,t.size),l.toTensor();for(a=0;a<c[0];++a){for(i=0;i<t.shape[1];++i)l.set(t.get(a,i),a,i);for(i=0;i<e.shape[1];++i)l.set(e.get(a,i),a,i+t.shape[1])}return l.toTensor()},t.prototype.neg=function(t){return this.multiply(s.scalar(-1),t)},t.prototype.add=function(t,e){return this.broadcastedBinaryOp(t,e,h.upcastType(t.dtype,e.dtype),(function(t,e){return t+e}))},t.prototype.subtract=function(t,e){return this.broadcastedBinaryOp(t,e,h.upcastType(t.dtype,e.dtype),(function(t,e){return t-e}))},t.prototype.pow=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))},t.prototype.matMul=function(t,e,n,r){var o,a,i,u,c,l,p=n?t.shape[0]:t.shape[1],f=n?t.shape[1]:t.shape[0],h=r?e.shape[0]:e.shape[1],d=t.dataSync(),g=e.dataSync(),y=n?[1,t.strides[0]]:[t.strides[0],1],m=y[0],v=y[1],x=r?[e.strides[0],1]:[1,e.strides[0]],T=x[0],b=x[1],E=f*m,A=h*T,C=new Float32Array(f*h),w=0;for(o=0;o<E;o+=m)for(a=0;a<A;a+=T){for(i=o,u=a,c=0,l=0;l<p;++l)c+=d[i]*g[u],i+=v,u+=b;C[w++]=c}return s.tensor2d(C,[f,h])},t.prototype.multiply=function(t,e){return this.broadcastedBinaryOp(t,e,h.upcastType(t.dtype,e.dtype),(function(t,e){return t*e}))},t.prototype.divide=function(t,e){var n,r;return"int32"===t.dtype&&"int32"===e.dtype?(r="int32",n=function(t,e){return Math.floor(t/e)}):(r="float32",n=function(t,e){return t/e}),this.broadcastedBinaryOp(t,e,r,n)},t.prototype.sum=function(t,e){var n,r,o,i,u,c,l,p,f,g,y,m;for(a.assertAxesAreInnerMostDims("sum",e,t.rank),r=(n=a.computeOutAndReduceShapes(t.shape,e))[0],o=n[1],i=h.upcastType(t.dtype,"int32"),u=s.zeros(r,i),c=d.sizeFromShape(o),l=u.dataSync(),p=t.dataSync(),f=0;f<l.length;++f){for(g=f*c,y=0,m=0;m<c;++m)y+=p[g+m];l[f]=y}return u},t.prototype.argMin=function(t,e){var n,r,o,i,u,c,l,p,f,h,g,y,m,v=[e];for(a.assertAxesAreInnerMostDims("argMin",v,t.rank),r=(n=a.computeOutAndReduceShapes(t.shape,v))[0],o=n[1],i=s.zeros(r,"int32"),u=d.sizeFromShape(o),c=i.dataSync(),l=t.dataSync(),p=0;p<c.length;++p){for(h=l[f=p*u],g=0,y=0;y<u;++y)(m=l[f+y])<h&&(h=m,g=y);c[p]=g}return i},t.prototype.argMax=function(t,e){var n,r,o,i,u,c,l,p,f,h,g,y,m,v=[e];for(a.assertAxesAreInnerMostDims("argMax",v,t.rank),r=(n=a.computeOutAndReduceShapes(t.shape,v))[0],o=n[1],i=s.zeros(r,"int32"),u=d.sizeFromShape(o),c=i.dataSync(),l=t.dataSync(),p=0;p<c.length;++p){for(h=l[f=p*u],g=0,y=0;y<u;++y)(m=l[f+y])>h&&(h=m,g=y);c[p]=g}return i},t.prototype.equal=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t===e?1:0}))},t.prototype.notEqual=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t!==e?1:0}))},t.prototype.less=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<e?1:0}))},t.prototype.lessEqual=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<=e?1:0}))},t.prototype.greater=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>e?1:0}))},t.prototype.greaterEqual=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>=e?1:0}))},t.prototype.logicalNot=function(t){var e,n=t.dataSync(),r=new Int32Array(n.length);for(e=0;e<n.length;++e)r[e]=n[e]?0:1;return f.Tensor.make(t.shape,{values:r},"bool")},t.prototype.logicalAnd=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t&&e}))},t.prototype.logicalOr=function(t,e){return this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t||e}))},t.prototype.where=function(t,e,n,r){var o,a,i=t.dataSync(),u=e.dataSync(),c=n.dataSync(),l=s.zeros(e.shape,r),p=l.dataSync(),f=0,h=0===t.rank||t.rank>1||1===e.rank?1:e.shape[1];for(o=0;o<i.length;o++)for(a=0;a<h;a++)1===i[o]?p[f++]=u[o]:p[f++]=c[o];return l},t.prototype.topKValues=function(t,e){return this.topK(t,e).values},t.prototype.topKIndices=function(t,e){return this.topK(t,e).indices},t.prototype.topK=function(t,e){var n,r,o,a=t.dataSync(),i=[];for(n=0;n<a.length;n++)i.push({value:a[n],index:n});for(i.sort((function(t,e){return e.value-t.value})),r=d.getTypedArrayFromDType(t.dtype,e),o=new Int32Array(e),n=0;n<e;n++)r[n]=i[n].value,o[n]=i[n].index;return{values:s.tensor1d(r,t.dtype),indices:s.tensor1d(o,"int32")}},t.prototype.min=function(t,e){var n,r,o,i,u,c,l,p,f,h,g,y;for(a.assertAxesAreInnerMostDims("min",e,t.rank),r=(n=a.computeOutAndReduceShapes(t.shape,e))[0],o=n[1],i=s.zeros(r,t.dtype),u=d.sizeFromShape(o),c=i.dataSync(),l=t.dataSync(),p=0;p<c.length;++p){for(f=p*u,h=l[0],g=0;g<u;++g)(y=l[f+g])<h&&(h=y);c[p]=h}return i},t.prototype.minimum=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))},t.prototype.mod=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))},t.prototype.max=function(t,e){var n,r,o,i,u,c,l,p,f,h,g,y;for(a.assertAxesAreInnerMostDims("max",e,t.rank),r=(n=a.computeOutAndReduceShapes(t.shape,e))[0],o=n[1],i=s.zeros(r,t.dtype),u=d.sizeFromShape(o),c=i.dataSync(),l=t.dataSync(),p=0;p<c.length;++p){for(h=l[f=p*u],g=0;g<u;++g)(y=l[f+g])>h&&(h=y);c[p]=h}return i},t.prototype.maximum=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))},t.prototype.squaredDifference=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))},t.prototype.ceil=function(t){var e,n=t.dataSync(),r=new Float32Array(n.length);for(e=0;e<n.length;++e)r[e]=Math.ceil(n[e]);return f.Tensor.make(t.shape,{values:r})},t.prototype.floor=function(t){var e,n=t.dataSync(),r=new Float32Array(n.length);for(e=0;e<n.length;++e)r[e]=Math.floor(n[e]);return f.Tensor.make(t.shape,{values:r})},t.prototype.sign=function(t){var e,n=t.dataSync(),r=new Float32Array(n.length);for(e=0;e<n.length;++e)n[e]<0?r[e]=-1:n[e]>0?r[e]=1:r[e]=0;return f.Tensor.make(t.shape,{values:r})},t.prototype.round=function(t){var e,n,r=t.dataSync(),o=new Float32Array(r.length);for(e=0;e<r.length;++e)n=Math.floor(r[e]),r[e]-n<.5?o[e]=Math.floor(r[e]):r[e]-n>.5?o[e]=Math.ceil(r[e]):o[e]=n%2==0?n:n+1;return f.Tensor.make(t.shape,{values:o})},t.prototype.exp=function(t){var e,n=t.dataSync(),r=new Float32Array(n.length);for(e=0;e<n.length;++e)r[e]=Math.exp(n[e]);return f.Tensor.make(t.shape,{values:r})},t.prototype.expm1=function(t){var e,n=t.dataSync(),r=new Float32Array(n.length);for(e=0;e<n.length;++e)r[e]=Math.expm1(n[e]);return f.Tensor.make(t.shape,{values:r})},t.prototype.log=function(t){var e,n,r=t.dataSync(),o=new Float32Array(r.length);for(e=0;e<r.length;++e)n=r[e],o[e]=Math.log(n);return f.Tensor.make(t.shape,{values:o})},t.prototype.log1p=function(t){var e,n,r=t.dataSync(),o=new Float32Array(r.length);for(e=0;e<r.length;++e)n=r[e],o[e]=Math.log1p(n);return f.Tensor.make(t.shape,{values:o})},t.prototype.sqrt=function(t){var e,n,r=t.dataSync(),o=new Float32Array(r.length);for(e=0;e<r.length;++e)n=r[e],o[e]=Math.sqrt(n);return f.Tensor.make(t.shape,{values:o})},t.prototype.rsqrt=function(t){var e,n,r=t.dataSync(),o=new Float32Array(r.length);for(e=0;e<r.length;++e)n=r[e],o[e]=1/Math.sqrt(n);return f.Tensor.make(t.shape,{values:o})},t.prototype.square=function(t){var e,n,r=t.dataSync(),o=new Float32Array(r.length);for(e=0;e<r.length;++e)n=r[e],o[e]=n*n;return f.Tensor.make(t.shape,{values:o})},t.prototype.reciprocal=function(t){var e,n=t.dataSync(),r=new Float32Array(n.length);for(e=0;e<n.length;++e)r[e]=1/n[e];return f.Tensor.make(t.shape,{values:r})},t.prototype.relu=function(t){var e,n=s.zeros(t.shape,t.dtype),r=n.dataSync(),o=t.dataSync();for(e=0;e<o.length;++e)r[e]=Math.max(0,o[e]);return n},t.prototype.elu=function(t){var e,n,r=new Float32Array(t.size),o=t.dataSync();for(e=0;e<o.length;++e)n=o[e],r[e]=n>=0?n:Math.exp(n)-1;return f.Tensor.make(t.shape,{values:r})},t.prototype.eluDer=function(t,e){var n,r,o=new Float32Array(e.size),a=e.dataSync(),i=t.dataSync();for(n=0;n<a.length;++n)r=a[n],o[n]=r>=1?i[n]:i[n]*(r+1);return f.Tensor.make(e.shape,{values:o})},t.prototype.selu=function(t){var e,n,r=l.SELU_SCALEALPHA,o=l.SELU_SCALE,a=new Float32Array(t.size),i=t.dataSync();for(e=0;e<i.length;++e)n=i[e],a[e]=n>=0?o*n:r*(Math.exp(n)-1);return f.Tensor.make(t.shape,{values:a})},t.prototype.clip=function(t,e,n){var r,o=new Float32Array(t.size),a=t.dataSync();for(r=0;r<a.length;++r)o[r]=Math.min(n,Math.max(e,a[r]));return f.Tensor.make(t.shape,{values:o})},t.prototype.abs=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=Math.abs(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.int=function(t){var e,n=new Int32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=r[e];return f.Tensor.make(t.shape,{values:n},"int32")},t.prototype.sigmoid=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=1/(1+Math.exp(-r[e]));return f.Tensor.make(t.shape,{values:n})},t.prototype.softplus=function(t){var e,n,r,o,a,i=-13.942385152878742,u=new Float32Array(t.size),s=t.dataSync();for(e=0;e<s.length;++e)n=s[e]>-i,r=s[e]<i,o=Math.exp(s[e]),a=r?o:n?s[e]:Math.log(1+o),u[e]=a;return f.Tensor.make(t.shape,{values:u})},t.prototype.sin=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=Math.sin(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.cos=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=Math.cos(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.tan=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=Math.tan(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.asin=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=Math.asin(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.acos=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=Math.acos(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.atan=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=Math.atan(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.atan2=function(t,e){return this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))},t.prototype.sinh=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=Math.sinh(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.cosh=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=Math.cosh(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.tanh=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=d.tanh(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.asinh=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=Math.asinh(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.acosh=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=Math.acosh(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.atanh=function(t){var e,n=new Float32Array(t.size),r=t.dataSync();for(e=0;e<r.length;++e)n[e]=Math.atanh(r[e]);return f.Tensor.make(t.shape,{values:n})},t.prototype.erf=function(t){var e,n,r,o=new Float32Array(t.size),a=t.dataSync(),i=p.ERF_P,u=p.ERF_A1,s=p.ERF_A2,c=p.ERF_A3,l=p.ERF_A4,h=p.ERF_A5;for(e=0;e<a.length;++e)r=1/(1+i*(n=a[e])),o[e]=1-((((h*r+l)*r+c)*r+s)*r+u)*r*Math.exp(-n*n);return f.Tensor.make(t.shape,{values:o})},t.prototype.step=function(t,e){var n,r,o,a;for(void 0===e&&(e=0),n=new Float32Array(t.size),r=t.dataSync(),o=0;o<r.length;++o)a=r[o],n[o]=isNaN(a)?NaN:a>0?1:e;return f.Tensor.make(t.shape,{values:n})},t.prototype.conv2d=function(t,e,n){var r,o,a,i,u,c,l,p,f,h,d,g,y=n.filterHeight,m=n.filterWidth,v=n.dilationHeight,x=n.dilationWidth,T=n.padInfo.left,b=n.padInfo.top,E=s.buffer(n.outShape,t.dtype);for(r=0;r<n.batchSize;++r)for(o=0;o<n.outChannels;++o)for(a=0;a<n.outHeight;++a)for(i=a*n.strideHeight-T,u=0;u<n.outWidth;++u){for(c=u*n.strideWidth-b,l=0,p=0;p<y;p++)if(!((f=i+p*v)<0||f>=n.inHeight))for(h=0;h<m;h++)if(!((d=c+h*x)<0||d>=n.inWidth))for(g=0;g<n.inChannels;++g)l+=t.get(r,f,d,g)*e.get(p,h,g,o);E.set(l,r,a,u,o)}return E.toTensor()},t.prototype.conv2dDerInput=function(t,e,n){var r,o,a,i,u,c,l,p,f,h,d,g,y,m,v,x,T=n.filterHeight,b=n.filterWidth,E=T-1-n.padInfo.top,A=b-1-n.padInfo.left,C=n.strideHeight,w=n.strideWidth,R=s.buffer(n.inShape,"float32");for(r=0;r<n.batchSize;++r)for(o=0;o<n.inChannels;++o)for(a=0;a<n.inHeight;++a)for(u=Math.max(0,Math.ceil((i=a-A)/C)),c=Math.min(n.outHeight,(T+i)/C),l=0;l<n.inWidth;++l){for(f=Math.max(0,Math.ceil((p=l-E)/w)),h=Math.min(n.outWidth,(b+p)/w),d=0,g=u;g<c;++g)for(y=g*C-i,m=f;m<h;++m)for(v=m*w-p,x=0;x<n.outChannels;++x)d+=t.get(r,g,m,x)*e.get(T-1-y,b-1-v,o,x);R.set(d,r,a,l,o)}return R.toTensor()},t.prototype.conv2dDerFilter=function(t,e,n){var r,o,a,i,u,c,l,p,f,h,d,g,y,m,v=n.strideHeight,x=n.strideWidth,T=n.filterHeight,b=n.filterWidth,E=s.buffer(n.filterShape,"float32"),A=n.padInfo.left,C=n.padInfo.top;for(r=0;r<T;++r)for(o=Math.max(0,Math.ceil((C-r)/v)),a=Math.min(n.outHeight,(n.inHeight+C-r)/v),i=0;i<b;++i)for(u=Math.max(0,Math.ceil((A-i)/x)),c=Math.min(n.outWidth,(n.inWidth+A-i)/x),l=0;l<n.inChannels;++l)for(p=0;p<n.outChannels;++p){for(f=0,h=0;h<n.batchSize;++h)for(d=o;d<a;++d)for(g=r+d*v-C,y=u;y<c;++y)m=i+y*x-A,f+=t.get(h,g,m,l)*e.get(h,d,y,p);E.set(f,r,i,l,p)}return E.toTensor()},t.prototype.depthwiseConv2D=function(t,e,n){var r,o,a,i,u,c,l,p,f,h,d,g,y=n.filterHeight,m=n.filterWidth,v=n.dilationHeight,x=n.dilationWidth,T=n.padInfo.left,b=n.padInfo.top,E=n.outChannels/n.inChannels,A=s.buffer(n.outShape,t.dtype);for(r=0;r<n.batchSize;++r)for(o=0;o<n.inChannels;++o)for(a=0;a<n.outHeight;++a)for(i=a*n.strideHeight-T,u=0;u<n.outWidth;++u)for(c=u*n.strideWidth-b,l=0;l<E;++l){for(p=0,f=0;f<y;++f)if(!((h=i+f*v)<0||h>=n.inHeight))for(d=0;d<m;++d)(g=c+d*x)<0||g>=n.inWidth||(p+=t.get(r,h,g,o)*e.get(f,d,o,l));A.set(p,r,a,u,o*E+l)}return A.toTensor()},t.prototype.tile=function(t,e){var n,r,o,a,i,u,c,l=Array(t.rank);for(n=0;n<l.length;n++)l[n]=t.shape[n]*e[n];for(r=s.buffer(l,t.dtype),o=t.buffer(),n=0;n<r.values.length;++n){for(a=r.indexToLoc(n),i=Array(t.rank),u=0;u<i.length;u++)i[u]=a[u]%t.shape[u];c=o.locToIndex(i),r.values[n]=o.values[c]}return r.toTensor()},t.prototype.pad=function(t,e,n){var r,o,a,i=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),u=e.map((function(t){return t[0]})),c=t.buffer(),l=s.buffer(i,t.dtype);for(0!==n&&l.values.fill(n),r=0;r<t.size;r++)a=(o=c.indexToLoc(r)).map((function(t,e){return t+u[e]})),l.set.apply(l,[t.get.apply(t,o)].concat(a));return l.toTensor()},t.prototype.transpose=function(t,e){var n,r,o,a,i,u,s,l,p=Array(t.rank);for(n=0;n<p.length;n++)p[n]=t.shape[e[n]];for(r=t.dataSync(),o=c.buffer(p,t.dtype),a=t.buffer(),n=0;n<t.size;++n){for(i=a.indexToLoc(n),u=Array(i.length),s=0;s<u.length;s++)u[s]=i[e[s]];l=o.locToIndex(u),o.values[l]=r[n]}return o.toTensor()},t.prototype.gather=function(t,e,n){var r,o,a,i,u,s,l=t.shape.slice(),p=e.dataSync();for(l[n]=p.length,r=c.buffer(l,t.dtype),o=t.buffer(),a=0;a<r.size;++a)(u=(i=r.indexToLoc(a)).slice())[n]=p[i[n]],s=o.locToIndex(u),r.values[a]=o.values[s];return r.toTensor()},t.prototype.pool=function(t,e,n){var r,o,a,i,u,c,l,p,f,h,d,g,y,m,v,x,T=e.strideHeight,b=e.strideWidth,E=e.filterHeight,A=e.filterWidth,C=s.buffer(e.outShape,"float32"),w=e.padInfo.top,R=e.padInfo.left;for(r=0;r<e.batchSize;++r)for(o=0;o<e.inChannels;++o)for(a=0;a<e.outHeight;++a)for(u=Math.max(0,i=a*T-w),c=Math.min(e.inHeight,E+i),l=0;l<e.outWidth;++l){for(f=Math.max(0,p=l*b-R),h=Math.min(e.inWidth,A+p),d="max"===n?-1/0:1/0,g=0,y=0,m=u;m<c;++m){for(v=f;v<h;++v)x=t.get(r,m,v,o),"max"===n&&x>d?d=x:"avg"===n&&(g+=x,y++);if(isNaN(d))break}C.set("avg"===n?g/y:d,r,a,l,o)}return C.toTensor()},t.prototype.maxPool=function(t,e){return this.pool(t,e,"max")},t.prototype.maxPoolPositions=function(t,e){var n,r,o,a,i,u,c,l,p,f,h,d,g,y,m,v,x,T=s.buffer(e.outShape,"int32"),b=e.strideHeight,E=e.strideWidth,A=e.filterHeight,C=e.filterWidth,w=e.padInfo.top,R=e.padInfo.left;for(n=0;n<e.batchSize;++n)for(r=0;r<e.inChannels;++r)for(o=0;o<e.outHeight;++o)for(i=Math.max(0,a=o*b-w),u=Math.min(e.inHeight,A+a),c=0;c<e.outWidth;++c){for(p=Math.max(0,l=c*E-R),f=Math.min(e.inWidth,C+l),h=-1/0,d=-1,g=i;g<u;++g)for(y=g-a,m=p;m<f;++m)v=m-l,(x=t.get(n,g,m,r))>h&&(h=x,d=y*C+v);T.set(d,n,o,c,r)}return T.toTensor()},t.prototype.maxPoolBackprop=function(t,e,n,r){var o,a,i,u,c,l,p,f,h,d,g,y,m=this.maxPoolPositions(e,r),v=r.strideHeight,x=r.strideWidth,T=r.filterHeight,b=r.filterWidth,E=b-1-r.padInfo.left,A=T-1-r.padInfo.top,C=s.buffer(e.shape,"float32");for(o=0;o<r.batchSize;++o)for(a=0;a<r.inChannels;++a)for(i=0;i<r.inHeight;++i)for(u=0;u<r.inWidth;++u){for(c=i-A,l=u-E,p=0,f=0;f<T;++f)if(!((h=(c+f)/v)<0||h>=r.outHeight||Math.floor(h)!==h))for(d=0;d<b;++d)(g=(l+d)/x)<0||g>=r.outWidth||Math.floor(g)!==g||0!=(y=T*b-1-m.get(o,h,g,a)===f*b+d?1:0)&&(p+=t.get(o,h,g,a)*y);C.set(p,o,i,u,a)}return C.toTensor()},t.prototype.avgPoolBackprop=function(t,e,n){var r,o,a,i,u,c,l,p,f,h,d,g=n.strideHeight,y=n.strideWidth,m=n.filterHeight,v=n.filterWidth,x=v-1-n.padInfo.left,T=m-1-n.padInfo.top,b=s.buffer(e.shape,"float32"),E=1/(m*v);for(r=0;r<n.batchSize;++r)for(o=0;o<n.inChannels;++o)for(a=0;a<n.inHeight;++a)for(i=0;i<n.inWidth;++i){for(u=a-T,c=i-x,l=0,p=0;p<m;++p)if(!((f=(u+p)/g)<0||f>=n.outHeight||Math.floor(f)!==f))for(h=0;h<v;++h)(d=(c+h)/y)<0||d>=n.outWidth||Math.floor(d)!==d||(l+=t.get(r,f,d,o));b.set(l*E,r,a,i,o)}return b.toTensor()},t.prototype.cast=function(t,e){return g.castTensor(t,e,this)},t.prototype.reshape=function(t,e){return g.reshapeTensor(t,e)},t.prototype.avgPool=function(t,e){return this.pool(t,e,"avg").toFloat()},t.prototype.resizeBilinear=function(t,e,n,r){var o,a,i,u,c,l,p,f,h,d,g,y,m,v,x,T=t.shape,b=T[0],E=T[1],A=T[2],C=T[3],w=s.buffer([b,e,n,C],t.dtype),R=r?[E-1,A-1]:[E,A],S=r?[e-1,n-1]:[e,n];for(o=0;o<b;o++)for(a=0;a<e;a++)for(i=0;i<n;i++)for(u=0;u<C;u++)l=R[1]*i/S[1],p=Math.floor(c=R[0]*a/S[0]),f=Math.min(E-1,Math.ceil(c)),h=Math.floor(l),d=Math.min(A-1,Math.ceil(l)),g=t.get(o,p,h,u),y=t.get(o,f,h,u),x=(v=g+(t.get(o,p,d,u)-g)*(m=l-h))+(y+(t.get(o,f,d,u)-y)*m-v)*(c-p),w.set(x,o,a,i,u);return w.toTensor()},t.prototype.resizeNearestNeighbor=function(t,e,n,r){var o,a,i,u,c,l,p,f,h=t.shape,d=h[0],g=h[1],y=h[2],m=h[3],v=s.buffer([d,e,n,m],t.dtype),x=r?[g-1,y-1]:[g,y],T=r?[e-1,n-1]:[e,n];for(o=0;o<d;o++)for(a=0;a<e;a++)for(i=0;i<n;i++)for(u=0;u<m;u++)c=x[1]*i/T[1],l=Math.min(g-1,Math.round(x[0]*a/T[0])),p=Math.min(y-1,Math.round(c)),f=t.get(o,l,p,u),v.set(f,o,a,i,u);return v.toTensor()},t.prototype.batchNormalization=function(t,e,n,r,o,a){var i,u=t.dataSync(),s=e.dataSync(),l=n.dataSync(),p=o?o.dataSync():new Float32Array([1]),f=a?a.dataSync():new Float32Array([0]),h=new Float32Array(u.length);for(i=0;i<u.length;i++)h[i]=f[i%f.length]+(u[i]-s[i%s.length])*p[i%p.length]/Math.sqrt(l[i%l.length]+r);return c.tensor4d(h,t.shape)},t.prototype.localResponseNormalization4D=function(t,e,n,r,o){function a(e,n,r,o){var a,i,u=0;for(a=Math.max(0,o-d);a<=Math.min(o+d,g);a++)u+=(i=t.get(e,n,r,a))*i;return u}var i,u,c,l,p,f,h=s.buffer(t.shape,"float32"),d=e,g=h.shape[3]-1;for(i=0;i<h.shape[0];i++)for(u=0;u<=h.shape[1];u++)for(c=0;c<h.shape[2];c++)for(l=0;l<h.shape[3];l++)p=a(i,u,c,l),f=t.get(i,u,c,l)*Math.pow(n+r*p,-o),h.set(f,i,u,c,l);return h.toTensor()},t.prototype.multinomial=function(t,e,n,o){var a,i,u,c,l,p,f,h,d,g=e?t:s.softmax(t),y=g.shape[0],m=g.shape[1],v=s.zeros([y,n],"int32"),x=v.dataSync(),T=g.dataSync();for(a=0;a<y;++a){for(i=a*m,(u=new Float32Array(m-1))[0]=T[i],c=1;c<u.length;++c)u[c]=u[c-1]+T[i+c];for(l=r.alea(o.toString()),p=a*n,f=0;f<n;++f)for(h=l(),x[p+f]=u.length,d=0;d<u.length;d++)if(h<u[d]){x[p+f]=d;break}}return v},t.prototype.oneHot=function(t,e,n,r){var o,a=new Float32Array(t.size*e);for(a.fill(r),o=0;o<t.size;++o)a[o*e+t.get(o)]=n;return s.tensor2d(a,[t.size,e])},t.prototype.broadcastedBinaryOp=function(t,e,n,r){var o,a=i.assertAndGetBroadcastShape(t.shape,e.shape),u=s.buffer(a,n),c=t.dataSync(),l=e.dataSync(),p=i.getBroadcastDims(t.shape,a),f=i.getBroadcastDims(e.shape,a),h=t.buffer(),d=e.buffer(),g=function(n){var o,a,i,s=u.indexToLoc(n),g=s.slice(-t.rank);p.forEach((function(t){return g[t]=0})),o=h.locToIndex(g),a=s.slice(-e.rank),f.forEach((function(t){return a[t]=0})),i=d.locToIndex(a),u.values[n]=r(c[o],l[i])};for(o=0;o<u.values.length;++o)g(o);return u.toTensor()},t.prototype.dispose=function(){},t}(),e.MathBackendCPU=y,o.ENV.registerBackend("cpu",(function(){return new y}),1)},2198:function(t,e,n){"use strict";var r,o,a=this&&this.__decorate||function(t,e,n,r){var o,a,i=arguments.length,u=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(a=t.length-1;a>=0;a--)(o=t[a])&&(u=(i<3?o(u):i>3?o(e,n,u):o(e,n))||u);return i>3&&u&&Object.defineProperty(e,n,u),u};Object.defineProperty(e,"__esModule",{value:!0}),r=n(638),o=function(){function t(){}return t.nextFrame=function(){return new Promise((function(t){return requestAnimationFrame((function(){return t()}))}))},a([r.doc({heading:"Performance",subheading:"Timing"})],t,"nextFrame",null),t}(),e.BrowserUtil=o},2218:function(t,e,n){"use strict";var r,o,a,i,u,s,c,l,p,f,h=this&&this.__extends||(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),r=n(711),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayer=function(t){return r.layers.activation(this.getTfjsConfig(t))},e}(n(783).OnnxNode),e.Activation=o,a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayerConfig=function(t){return{activation:"relu"}},e}(o),e.Relu=a,i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayerConfig=function(t){return{activation:"tanh"}},e}(o),e.Tanh=i,u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayerConfig=function(t){return{activation:"sigmoid"}},e}(o),e.Sigmoid=u,s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayerConfig=function(t){return{activation:"elu"}},e}(o),e.Elu=s,c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayerConfig=function(t){return{activation:"softplus"}},e}(o),e.Softplus=c,l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayerConfig=function(t){return{activation:"softsign"}},e}(o),e.Softsign=l,p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayerConfig=function(t){return{activation:"hardsigmoid"}},e}(o),e.HardSigmoid=p},2235:function(t,e,n){"use strict";var r,o,a,i,u,s=this&&this.__extends||(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),r=n(711),o=n(783),a=n(735),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.getTfjsLayerConfig=function(t,e){var n=a.getNamedAttrs(t.attribute),r=a.parseAttrOrDefault(n.axis,0),o=e[0].shape;return{axis:a.parseOnnxAxis(r,o)}},e.prototype.getTfjsLayer=function(t,e){var n=this.getTfjsConfig(t,e);return r.layers.softmax(n)},e}(o.OnnxNode),e.Softmax=i},2236:function(t,e,n){"use strict";var r,o,a,i,u,s,c,l,p=this&&this.__extends||(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),r=n(711),o=n(783),a=n(735),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.getTfjsLayerConfig=function(t){var e=t.input[1],n=t.input[2],r=this.model.blobShapes[e][0],a=this.model.blobValues[e],i=this.model.blobValues[n];return{units:r,kernelInitializer:new o.WeightInitializer(a),biasInitializer:new o.WeightInitializer(i)}},e.prototype.getTfjsLayer=function(t){var e=this.getTfjsConfig(t);return r.layers.dense(e)},e}(o.OnnxNode),e.Dense=i,u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.getTfjsLayerConfig=function(t){var e=a.getNamedAttrs(t.attribute);return{rate:a.parseAttrOrDefault(e.ratio,0)}},e.prototype.getTfjsLayer=function(t){var e=this.getTfjsConfig(t);return r.layers.dropout(e)},e}(o.OnnxNode),e.Dropout=u,s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.getTfjsLayerConfig=function(t){return{}},e.prototype.getTfjsLayer=function(t){var e=this.getTfjsConfig(t);return r.layers.flatten(e)},e}(o.OnnxNode),e.Flatten=s,c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.getTfjsLayerConfig=function(t){var e=t.input[1],n=this.model.blobShapes[e];return{targetShape:a.parseOnnxShape(n)}},e.prototype.getTfjsLayer=function(t){var e=this.getTfjsConfig(t);return r.layers.reshape(e)},e}(o.OnnxNode),e.Reshape=c},2237:function(t,e,n){"use strict";var r,o,a,i,u,s,c,l=this&&this.__extends||(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),r=n(711),o=n(783),a=n(735),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.getTfjsLayerConfig=function(t,e){var n=a.getNamedAttrs(t.attribute),r=a.parseAttrOrDefault(n.axis,0),o=e[0].shape;return{axis:a.parseOnnxAxis(r,o)}},e.prototype.getTfjsLayer=function(t,e){var n=this.getTfjsConfig(t,e);return r.layers.concatenate(n)},e}(o.OnnxNode),e.Concat=i,u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.getTfjsLayerConfig=function(t){return{}},e.prototype.getTfjsLayer=function(t){var e=this.getTfjsConfig(t);return r.layers.add(e)},e}(o.OnnxNode),e.Add=u,s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.getTfjsLayerConfig=function(t){return{}},e.prototype.getTfjsLayer=function(t){var e=this.getTfjsConfig(t);return r.layers.multiply(e)},e}(o.OnnxNode),e.Mul=s},2238:function(t,e,n){"use strict";var r,o,a,i,u,s,c,l,p,f,h=this&&this.__extends||(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),r=n(711),o=n(783),a=n(735),i=n(1274),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayerConfig=function(t){var e=a.getNamedAttrs(t.attribute),n=a.parseAttrOrDefault(e.kernel_shape),r=a.parseAttrOrDefault(e.strides,1),o=a.parseAttrOrDefault(e.pads,null),u=a.parseAttrOrDefault(e.auto_pad,null);return{poolSize:n,strides:r,padding:i.Conv.getTfjsPadding(o,u)}},e.getPoolDim=function(t){var e=a.getNamedAttrs(t.attribute);return a.parseAttrOrDefault(e.kernel_shape,[]).length||2},e}(o.OnnxNode),e.Pool=u,s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayer=function(t){var e=u.getPoolDim(t),n=this.getTfjsConfig(t);return 1==e?r.layers.maxPooling1d(n):r.layers.maxPooling2d(n)},e}(u),e.MaxPool=s,c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayer=function(t){var e=u.getPoolDim(t),n=this.getTfjsConfig(t);return 1==e?r.layers.averagePooling1d(n):r.layers.averagePooling2d(n)},e}(u),e.AveragePool=c,l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayer=function(t){var e=u.getPoolDim(t),n=this.getTfjsConfig(t);return 1==e?r.layers.globalMaxPooling1d(n):r.layers.globalMaxPooling2d(n)},e}(u),e.GlobalMaxPool=l,p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.getTfjsLayer=function(t){var e=u.getPoolDim(t),n=this.getTfjsConfig(t);return 1==e?r.layers.globalAveragePooling1d(n):r.layers.globalAveragePooling2d(n)},e}(u),e.GlobalAveragePool=p},632:function(t,e,n){"use strict";(function(t){function r(t,e){return null!=t.getExtension(e)}function o(t){if(0===t)throw Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=document.createElement("canvas");return 1===t?e.getContext("webgl")||e.getContext("experimental-webgl"):e.getContext("webgl2")}function a(t){if(null!=t){var e=t.getExtension("WEBGL_lose_context");if(null==e)throw Error("Extension WEBGL_lose_context not supported on this browser.");e.loseContext()}}function i(t){var e=o(t);return null!=e&&(a(e),!0)}function u(){var t,n,r={};return"undefined"==typeof window||(t=p.getQueryParams(window.location.search),d in t&&(n={},t[d].split(",").forEach((function(t){var e=t.split(":"),r=e[0],o=e[1];n[r]=o})),e.URL_PROPERTIES.forEach((function(t){t.name in n&&(console.log("Setting feature override from URL "+t.name+": "+n[t.name]),t.type===f.NUMBER?r[t.name]=+n[t.name]:t.type===f.BOOLEAN?r[t.name]="true"===n[t.name]:t.type===f.STRING?r[t.name]=n[t.name]:console.warn("Unknown URL param: "+t.name+"."))})))),r}var s,c,l,p,f,h,d,g,y=this&&this.__decorate||function(t,e,n,r){var o,a,i=arguments.length,u=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(a=t.length-1;a>=0;a--)(o=t[a])&&(u=(i<3?o(u):i>3?o(e,n,u):o(e,n))||u);return i>3&&u&&Object.defineProperty(e,n,u),u};Object.defineProperty(e,"__esModule",{value:!0}),s=n(2135),c=n(638),l=n(2136),p=n(630),function(t){t[t.NUMBER=0]="NUMBER",t[t.BOOLEAN=1]="BOOLEAN",t[t.STRING=2]="STRING"}(f=e.Type||(e.Type={})),e.URL_PROPERTIES=[{name:"DEBUG",type:f.BOOLEAN},{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",type:f.NUMBER},{name:"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",type:f.BOOLEAN},{name:"WEBGL_VERSION",type:f.NUMBER},{name:"WEBGL_FLOAT_TEXTURE_ENABLED",type:f.BOOLEAN},{name:"WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED",type:f.BOOLEAN},{name:"BACKEND",type:f.STRING}],h=function(){function t(t){this.features={},this.registry={},null!=t&&(this.features=t),this.get("DEBUG")&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}return t.setBackend=function(t,n){if(void 0===n&&(n=!1),!(t in e.ENV.registry))throw Error("Backend type '"+t+"' not found in registry");e.ENV.initBackend(t,n)},t.getBackend=function(){return e.ENV.initDefaultBackend(),e.ENV.currentBackend},t.memory=function(){return e.ENV.engine.memory()},t.prototype.get=function(t){return t in this.features||(this.features[t]=this.evaluateFeature(t)),this.features[t]},t.prototype.set=function(t,e){this.features[t]=e},t.prototype.getBestBackendType=function(){var t=this;if(0===Object.keys(this.registry).length)throw Error("No backend found in registry.");return Object.keys(this.registry).map((function(e){return{name:e,entry:t.registry[e]}})).sort((function(t,e){return e.entry.priority-t.entry.priority}))[0].name},t.prototype.evaluateFeature=function(t){if("DEBUG"===t)return!1;if("BACKEND"===t)return this.getBestBackendType();if("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"===t){var e=this.get("WEBGL_VERSION");return 0===e?0:function(t){var e,n;return 0===t?0:(e=r(n=o(t),"EXT_disjoint_timer_query_webgl2")&&2===t?2:r(n,"EXT_disjoint_timer_query")?1:0,null!=n&&a(n),e)}(e)}if("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE"===t)return this.get("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!s.isMobile();if("WEBGL_VERSION"===t)return i(2)?2:i(1)?1:0;if("WEBGL_FLOAT_TEXTURE_ENABLED"===t)return function(t){var e,n,i,u,s,c;if(0===t)return!1;if(e=o(t),1===t){if(!r(e,"OES_texture_float"))return!1}else if(!r(e,"EXT_color_buffer_float"))return!1;return n=e.createFramebuffer(),i=e.createTexture(),e.bindTexture(e.TEXTURE_2D,i),u=2===t?e.RGBA32F:e.RGBA,e.texImage2D(e.TEXTURE_2D,0,u,1,1,0,e.RGBA,e.FLOAT,null),e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE,e.readPixels(0,0,1,1,e.RGBA,e.FLOAT,new Float32Array(4)),c=e.getError()===e.NO_ERROR,a(e),s&&c}(this.get("WEBGL_VERSION"));if("WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED"===t)return function(t){var e,n;return!(t>0)&&2===t&&(n=r(e=o(t),"WEBGL_get_buffer_sub_data_async"),a(e),n)}(this.get("WEBGL_VERSION"));throw Error("Unknown feature "+t+".")},t.prototype.setFeatures=function(t){this.features=t},t.prototype.reset=function(){this.features=u(),null!=this.globalEngine&&(this.globalEngine.dispose(),this.globalEngine=null)},t.prototype.initBackend=function(t,n){void 0===n&&(n=!1),this.currentBackend=t,null!=this.globalEngine&&this.globalEngine.dispose();var r=e.ENV.findBackend(t);this.globalEngine=new l.Engine(r,n)},t.prototype.findBackend=function(t){return t in this.registry?this.registry[t].backend:null},t.prototype.registerBackend=function(t,e,n){void 0===n&&(n=1),t in this.registry&&console.warn(t+" backend was already registered");try{var r=e();return this.registry[t]={backend:r,priority:n},!0}catch(o){return console.warn(o.message),!1}},t.prototype.removeBackend=function(t){if(!(t in this.registry))throw Error(t+" backend not found in registry");this.registry[t].backend.dispose(),delete this.registry[t]},Object.defineProperty(t.prototype,"engine",{get:function(){return this.initDefaultBackend(),this.globalEngine},enumerable:!0,configurable:!0}),t.prototype.initDefaultBackend=function(){null==this.globalEngine&&this.initBackend(e.ENV.get("BACKEND"),!1)},y([c.doc({heading:"Environment"})],t,"setBackend",null),y([c.doc({heading:"Environment"})],t,"getBackend",null),y([c.doc({heading:"Performance",subheading:"Memory"})],t,"memory",null),t}(),e.Environment=h,d="tfjsflags",e.ENV=((g=function(){var e;if("undefined"!=typeof window)e=window;else{if(void 0===t)throw Error("Could not find a global object");e=t}return e}()).ENV=g.ENV||new h(u()),g.ENV)}).call(this,n(73))},638:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.doc=function(t){return function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]}}},644:function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}var o,a,i,u,s,c,l,p,f,h,d,g,y,m,v,x,T,b,E,A,C,w;Object.defineProperty(e,"__esModule",{value:!0}),n(2134),n(2197),o=n(2198),a=n(632),e.environment=a,i=n(632),u=n(1262),s=n(900),c=n(2199),e.test_util=c,l=n(630),e.util=l,p=n(2200),e.version_core=p.version,f=n(1040),e.AdadeltaOptimizer=f.AdadeltaOptimizer,h=n(1041),e.AdagradOptimizer=h.AdagradOptimizer,d=n(1042),e.AdamOptimizer=d.AdamOptimizer,g=n(1043),e.AdamaxOptimizer=g.AdamaxOptimizer,y=n(1044),e.MomentumOptimizer=y.MomentumOptimizer,m=n(757),e.Optimizer=m.Optimizer,v=n(1045),e.RMSPropOptimizer=v.RMSPropOptimizer,x=n(901),e.SGDOptimizer=x.SGDOptimizer,T=n(712),e.Tensor=T.Tensor,e.TensorBuffer=T.TensorBuffer,e.variable=T.variable,e.Variable=T.Variable,b=n(756),e.Rank=b.Rank,E=n(2201),e.loadWeights=E.loadWeights,r(n(656)),A=n(1259),e.Reduction=A.Reduction,r(n(2202)),r(n(679)),C=n(632),e.ENV=C.ENV,e.Environment=C.Environment,e.setBackend=i.Environment.setBackend,e.getBackend=i.Environment.getBackend,e.memory=i.Environment.memory,w=n(638),e.doc=w.doc,e.nextFrame=o.BrowserUtil.nextFrame,e.webgl={webgl_util:s,gpgpu_util:u}},679:function(t,e,n){"use strict";var r,o;Object.defineProperty(e,"__esModule",{value:!0}),r=n(2137),o=n(2165),e.tidy=o.Tracking.tidy,e.keep=o.Tracking.keep,e.dispose=o.Tracking.dispose,e.time=o.Tracking.time,e.grad=r.Gradients.grad,e.valueAndGrad=r.Gradients.valueAndGrad,e.grads=r.Gradients.grads,e.valueAndGrads=r.Gradients.valueAndGrads,e.variableGrads=r.Gradients.variableGrads,e.customGrad=r.Gradients.customGrad},732:function(t,e,n){"use strict";function r(t){var e,n=t.shapeInfo.logicalShape;switch(n.length){case 0:return"\n    float get"+(e=t.name).charAt(0).toUpperCase()+e.slice(1)+"() {\n      return sampleTexture("+e+", halfCR);\n    }\n  ";case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);return"\n    float "+n+"(int index) {\n      return "+n+"Flat(index);\n    }\n  "}(t);case 2:return function(t){var e,n,i,s,c,l=t.shapeInfo.logicalShape,p=t.shapeInfo.texShape,f=t.name,h="get"+f.charAt(0).toUpperCase()+f.slice(1),d=p[0],g=p[1];return u.arraysEqual(l,p)?"\n    float "+h+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+g+".0, "+d+".0);\n      return sampleTexture("+f+", uv);\n    }\n  ":(n=(e=u.squeezeShape(l)).newShape,i=e.keptDims,(s=n).length<l.length?(c=["row","col"],"\n      "+r(o(t,s))+"\n      float "+h+"(int row, int col) {\n        return "+h+"("+a(c,i)+");\n      }\n    "):1===g?"\n    float "+h+"(int row, int col) {\n      int index = row * "+l[1]+" + col;\n      vec2 uv = vec2(0.5, (float(index) + 0.5) / "+d+".0);\n      return sampleTexture("+f+", uv);\n    }\n  ":1===d?"\n    float "+h+"(int row, int col) {\n      int index = row * "+l[1]+" + col;\n      vec2 uv = vec2((float(index) + 0.5) / "+g+".0, 0.5);\n      return sampleTexture("+f+", uv);\n    }\n  ":"\n  float "+h+"(int row, int col) {\n    vec2 uv = UVfrom2D("+d+", "+g+", "+l[1]+", row, col);\n    return sampleTexture("+f+", uv);\n  }\n")}(t);case 3:return function(t){var e,n=t.shapeInfo.texShape,i=t.shapeInfo.logicalShape,s=t.name,c="get"+s.charAt(0).toUpperCase()+s.slice(1),l=n[0],p=n[1],f=i[1]*i[2],h=i[2],d=u.squeezeShape(i),g=d.newShape,y=d.keptDims,m=g;return m.length<i.length?(e=["row","col","depth"],"\n        "+r(o(t,m))+"\n        float "+c+"(int row, int col, int depth) {\n          return "+c+"("+a(e,y)+");\n        }\n      "):p===f?"\n        float "+c+"(int row, int col, int depth) {\n          int texR = row;\n          int texC = col * "+h+" + depth;\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+p+".0, "+l+".0);\n          return sampleTexture("+s+", uv);\n        }\n      ":p===h?"\n    float "+c+"(int row, int col, int depth) {\n      int texR = row * "+i[1]+" + col;\n      int texC = depth;\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+p+".0, "+l+".0);\n      return sampleTexture("+s+", uv);\n    }\n  ":"\n      float "+c+"(int row, int col, int depth) {\n        vec2 uv = UVfrom3D(\n            "+l+", "+p+", "+f+", "+h+", row, col, depth);\n        return sampleTexture("+s+", uv);\n      }\n  "}(t);case 4:return function(t){var e,n=t.shapeInfo.logicalShape,i=t.shapeInfo.texShape,s=t.name,c="get"+s.charAt(0).toUpperCase()+s.slice(1),l=i[0],p=i[1],f=n[3],h=n[2]*f,d=n[1]*h,g=u.squeezeShape(n),y=g.newShape,m=g.keptDims;return y.length<n.length?(e=["row","col","depth","depth2"],"\n      "+r(o(t,y))+"\n      float "+c+"(int row, int col, int depth, int depth2) {\n        return "+c+"("+a(e,m)+");\n      }\n    "):p===d?"\n      float "+c+"(int row, int col, int depth, int depth2) {\n        int texR = row;\n        int texC = col * "+h+" + depth * "+f+" + depth2;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+p+".0, "+l+".0);\n        return sampleTexture("+s+", uv);\n      }\n    ":p===f?"\n      float "+c+"(int row, int col, int depth, int depth2) {\n        int texR = row * "+n[1]*n[2]+" + col * "+n[2]+" + depth;\n        int texC = depth2;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+p+".0, "+l+".0);\n        return sampleTexture("+s+", uv);\n      }\n    ":"\n    float "+c+"(int row, int col, int depth, int depth2) {\n      vec2 uv = UVfrom4D("+l+", "+p+", "+d+", "+h+",\n          "+f+", row, col, depth, depth2);\n      return sampleTexture("+s+", uv);\n    }\n  "}(t);default:throw Error(n.length+"-D input sampling is not yet supported")}}function o(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function a(t,e){return e.map((function(e){return t[e]})).join(", ")}var i,u,s,c,l,p,f,h,d;Object.defineProperty(e,"__esModule",{value:!0}),i=n(632),u=n(630),s=n(731),c=n(829),e.makeShader=function(t,e,n,o){var a=i.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?f:l,c=i.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")?h:p,g=t.map((function(t){return"uniform sampler2D "+t.name+";"})).join("\n"),y=t.map((function(t){return function(t,e,n){var o,a,i,c,l,p,f=(a=(o=t).name,i=o.shapeInfo.texShape,c="get"+a.charAt(0).toUpperCase()+a.slice(1)+"Flat",l=i[0],1===(p=i[1])&&1===l?"\n      float "+c+"(int index) {\n        return sampleTexture("+a+", halfCR);\n      }\n    ":1===p?"\n      float "+c+"(int index) {\n        vec2 uv = vec2(0.5, (float(index) + 0.5) / "+l+".0);\n        return sampleTexture("+a+", uv);\n      }\n    ":1===l?"\n      float "+c+"(int index) {\n        vec2 uv = vec2((float(index) + 0.5) / "+p+".0, 0.5);\n        return sampleTexture("+a+", uv);\n      }\n    ":"\n    float "+c+"(int index) {\n      vec2 uv = UVfrom1D("+l+", "+p+", index);\n      return sampleTexture("+a+", uv);\n    }\n  ");return f+=r(t),(n||u.arraysEqual(t.shapeInfo.logicalShape,e.logicalShape))&&(f+=function(t,e,n){var r,o,a,i=t.shapeInfo.texShape,c=t.name,l=c.charAt(0).toUpperCase()+c.slice(1),p="get"+l+"AtOutCoords",f=s.getBroadcastDims(t.shapeInfo.logicalShape,e.logicalShape),h=t.shapeInfo.logicalShape.length,d=e.logicalShape.length,g=n&&(d>h||f.length>0),y=s.broadcastDimsAreOuter(f);return g&&!y?function(t,e,n,r){var o,a,i=t.shapeInfo.logicalShape.length,u=e.logicalShape.length,c="int";return 2===u?c="ivec2":3===u?c="ivec3":4===u&&(c="ivec4"),o=s.getBroadcastDims(t.shapeInfo.logicalShape,e.logicalShape),a=u-i,"\n    float "+r+"() {\n      "+c+" coords = getOutputCoords();\n      "+(0===i?"":u<2&&o.length>=1?"coords = 0;":o.map((function(t){return"coords["+(t+a)+"] = 0;"})).join("\n"))+"\n      return get"+n+"("+(u<2&&i>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords["+(e+a)+"]"})).join(", "))+");\n    }\n  "}(t,e,l,p):(r=e.texShape,u.arraysEqual(i,r)?"\n      float "+p+"() {\n        return sampleTexture("+c+", resultUV);\n      }\n    ":(o=u.sizeFromShape(i),a="",g&&y&&(a="\n        int mainPart = index / "+o+";\n        index -= mainPart * "+o+";\n      "),"\n    float "+p+"() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+r[0]+", "+r[1]+"));\n      int index = resTexRC.x * "+r[1]+" + resTexRC.y;\n      "+a+"\n      int texR = index / "+i[1]+";\n      int texC = index - texR * "+i[1]+";\n      vec2 uv = (vec2(texC, texR) + halfCR) /\n                 vec2("+i[1]+".0, "+i[0]+".0);\n\n      return sampleTexture("+c+", uv);\n    }\n  "))}(t,e,n)),f}(t,e,o)})).join("\n"),m=e.texShape,v=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return u.arraysEqual(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return r=e,o=(n=t)[1]*n[2],a=n[2],"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+r[0]+", "+r[1]+"));\n      int index = resTexRC.x * "+r[1]+" + resTexRC.y;\n      int r = index / "+o+";\n      index -= r * "+o+";\n      int c = index / "+a+";\n      int d = index - c * "+a+";\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(t,e){var n=t[3],r=t[2]*n,o=t[1]*r;return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      int r = index / "+o+";\n      index -= r * "+o+";\n\n      int c = index / "+r+";\n      index -= c * "+r+";\n\n      int d = index / "+n+";\n      int d2 = index - d * "+n+";\n\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);default:throw Error(t.length+"-D output sampling is not yet supported")}var n,r,o,a}(e.logicalShape,m);return[d,a,c,g,v,y,n].join("\n")},l="\n  uniform float NaN;\n\n  const vec4 floatDeltas = vec4(\n      1.0,\n      1.0 / 255.0,\n      1.0 / (255.0 * 255.0),\n      1.0 / (255.0 * 255.0 * 255.0)\n  );\n  const float minValue = "+c.FLOAT_MIN+".0;\n  const float maxValue = "+c.FLOAT_MAX+".0;\n  const float range = (maxValue - minValue) / 255.0;\n  const vec2 dotRange = vec2(1.0, range);\n\n  float sampleTexture(sampler2D textureSampler, vec2 uv) {\n    vec4 sampleValue = texture2D(textureSampler, uv);\n    if (all(equal(sampleValue, vec4("+c.BYTE_NAN_VALUE+")))) {\n      return NaN;\n    }\n\n    vec4 encValue = floor(sampleValue * 255.0 + 0.5);\n    float decodedValue = dot(encValue, floatDeltas);\n    return dot(vec2(minValue, decodedValue), dotRange);\n  }\n",p="\n  const vec4 floatPowers = vec4(\n    1.0,\n    255.0,\n    255.0 * 255.0,\n    255.0 * 255.0 * 255.0\n  );\n  const vec2 recipRange = vec2(1.0/range);\n  const vec2 recipRange255 = vec2(1.0/(maxValue - minValue));\n\n  void setOutput(float decodedValue) {\n    if (isNaN(decodedValue)) {\n      gl_FragColor = vec4("+c.BYTE_NAN_VALUE+");\n      return;\n    }\n\n    float a = dot(vec2(decodedValue, -minValue), recipRange);\n    float b = fract(a) * 255.0;\n    float c = fract(b) * 255.0;\n    float d = fract(c) * 255.0;\n    gl_FragColor = floor(vec4(a, b, c, d)) / 255.0;\n\n    // TODO(dsmilkov): Version above gets better accuracy but probably slower\n    // than the version below. Benchmark to determine if the accuracy is worth\n    // the cost.\n\n    // float normValue = dot(vec2(decodedValue, -minValue), recipRange255);\n    // vec4 f = normValue * floatPowers;\n    // gl_FragColor = floor(fract(f) * 255.0) / 255.0;\n  }\n",f="\n  float sampleTexture(sampler2D textureSampler, vec2 uv) {\n    return texture2D(textureSampler, uv).r;\n  }\n",h="\n  void setOutput(float val) {\n    gl_FragColor = vec4(val, 0, 0, 0);\n  }\n",d="\n  precision highp float;\n  precision highp int;\n  varying vec2 resultUV;\n  const vec2 halfCR = vec2(0.5, 0.5);\n\n  bool isNaN(float val) {\n    float v1 = val * val;\n    float v2 = val * val;\n    return v1 == v2 ? false : true;\n  }\n\n  bool hasNaN(vec4 values) {\n    vec4 v1 = values * values;\n    vec4 v2 = values * values;\n    return any(notEqual(v1, v2));\n  }\n\n  float getNaN(vec4 values) {\n    return dot(vec4(1), values);\n  }\n\n  int round(float value) {\n    return int(floor(value + 0.5));\n  }\n\n  int imod(int x, int y) {\n    return x - y * (x / y);\n  }\n\n  const vec2 randomConst = vec2(\n    23.14069263277926, // e^pi (Gelfond's constant)\n     2.665144142690225 // 2^sqrt(2) (GelfondSchneider constant)\n  );\n\n  float random(float seed) {\n      return fract(cos(dot(resultUV * seed, randomConst)) * 12345.6789);\n  }\n\n  \nvec2 UVfrom1D(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom2D(int texNumR, int texNumC, int numC, int row, int col) {\n  int index = row * numC + col;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom3D(int texNumR, int texNumC, int stride0,\n    int stride1, int row, int col, int depth) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n  \nvec2 UVfrom4D(int texNumR, int texNumC, int stride0,\n    int stride1, int stride2, int row, int col, int depth,\n    int depth2) {\n  // Explicitly use integer operations as dot() only works on floats.\n  int index = row * stride0 + col * stride1 + depth * stride2 + depth2;\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n\n",e.getCoordsDataType=function(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";throw Error("GPU for rank "+t+" is not yet supported")}},735:function(t,e,n){"use strict";function r(t,e){var n,r={};for(n=0;n<t.length;n++)r[t[n][e]]=t[n];return r}function o(t,e){var n,r={};for(n=0;n<t.length;n++)r[t[n]]=e[n];return r}function a(t){return fetch(new Request(t)).then(i).then((function(t){return t.arrayBuffer()}))}function i(t){if(!t.ok)throw Error(t.statusText);return t}function u(t){return y.onnx.ModelProto.decode(new Uint8Array(t))}function s(t){switch(t.type){case y.onnx.AttributeProto.AttributeType.FLOAT:return t.f;case y.onnx.AttributeProto.AttributeType.INT:return t.i;case y.onnx.AttributeProto.AttributeType.STRING:return t.s;case y.onnx.AttributeProto.AttributeType.TENSOR:return t.t;case y.onnx.AttributeProto.AttributeType.GRAPH:return t.g;case y.onnx.AttributeProto.AttributeType.FLOATS:return t.floats;case y.onnx.AttributeProto.AttributeType.INTS:return t.ints;case y.onnx.AttributeProto.AttributeType.STRINGS:return t.strings;case y.onnx.AttributeProto.AttributeType.TENSORS:return t.tensors;case y.onnx.AttributeProto.AttributeType.GRAPHS:return t.graphs;case y.onnx.AttributeProto.AttributeType.UNDEFINED:default:throw Error("Cannot parse attr '"+t.name+"'")}}function c(t){switch(t.dataType){case y.onnx.TensorProto.DataType.INT8:throw Error("Cannot use 'int8' tensor in tfjs");case y.onnx.TensorProto.DataType.INT16:throw Error("Cannot use 'int16' tensor in tfjs");case y.onnx.TensorProto.DataType.INT32:return g.DType.int32;case y.onnx.TensorProto.DataType.INT64:throw Error("'Int64Array' type not suppoert in JavaScript");case y.onnx.TensorProto.DataType.UINT8:throw Error("Cannot use 'uint8' tensor in tfjs");case y.onnx.TensorProto.DataType.UINT16:throw Error("Cannot use 'uint16' tensor in tfjs");case y.onnx.TensorProto.DataType.UINT32:throw Error("Cannot use 'uint32' tensor in tfjs");case y.onnx.TensorProto.DataType.UINT16:throw Error("Cannot use 'uint64' tensor in tfjs");case y.onnx.TensorProto.DataType.FLOAT:return g.DType.float32;case y.onnx.TensorProto.DataType.DOUBLE:return console.warn("'double' type is not supported in tfjs. Converting to "+g.DType.float32),g.DType.float32;case y.onnx.TensorProto.DataType.UNDEFINED:default:throw Error("Cannot parse tensor '"+t.dataType+"'")}}function l(t){var e=function(t){return new Uint8Array(t).buffer};switch(t.dataType){case y.onnx.TensorProto.DataType.INT32:return new Int32Array(e(t.rawData));case y.onnx.TensorProto.DataType.FLOAT:return new Float32Array(e(t.rawData));case y.onnx.TensorProto.DataType.DOUBLE:return new Float32Array(new Float64Array(e(t.rawData)));case y.onnx.TensorProto.DataType.UNDEFINED:default:throw Error("Cannot parse tensor '"+t.dataType+"'")}}function p(t){return t.dim.map((function(t){return t.dimValue}))}function f(t){var e=t.map((function(t){return t.type.tensorType.shape})).map(p);return o(t.map((function(t){return t.name})),e)}function h(t){var e=t.dims,n=c(t),r=l(t),o=d.tensor(r,e,n);return 4==e.length?o.transpose([3,2,1,0]):o}var d,g,y,m=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{s(r.next(t))}catch(e){a(e)}}function u(t){try{s(r.throw(t))}catch(e){a(e)}}function s(t){t.done?o(t.value):new n((function(e){e(t.value)})).then(i,u)}s((r=r.apply(t,e||[])).next())}))},v=this&&this.__generator||function(t,e){function n(n){return function(i){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!((a=(a=u.trys).length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(i){n=[6,i],o=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,i])}}var r,o,a,i,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i};Object.defineProperty(e,"__esModule",{value:!0}),d=n(711),g=n(756),y=n(2219),e.normalizeArrayToObj=r,e.joinArraysToObj=o,e.isNotNull=function(t){return null!=t},e.fetchText=function(t){return fetch(new Request(t)).then(i).then((function(t){return t.text()}))},e.fetchArrayBuffer=a,e.parseOnnxAxis=function(t,e){return 4==e.length&&1==t?3:t},e.parseOnnxShape=function(t){var e=t[0],n=t[1],r=t[2],o=t[3];return 4==t.length?[e,r,o,n]:t},e.parseOnnxModel=u,e.parseAttrOrDefault=function(t,e){return void 0===t?e:s(t)},e.parseOnnxAttr=s,e.onnxTensorTypeToTfjsDtype=c,e.parseOnnxTensor=l,e.onnxShapeToTfjsShape=p,e.getNamedAttrs=function(t){return r(t,"name")},e.getTfjsCommonConfig=function(t){return{name:t.name}},e.loadOnnxModel=function(t){return m(this,void 0,void 0,(function(){return v(this,(function(e){switch(e.label){case 0:return[4,a(t)];case 1:return[4,u(e.sent())];case 2:return[2,e.sent()]}}))}))},e.getBlobValues=function(t){var e=t.initializer,n=e.map(h);return o(e.map((function(t){return t.name})),n)},e.getValueInfo=f,e.getBlobShapes=function(t){var e=f(t.input),n=f(t.output);return Object.assign({},e,n)},e.getInputShape=function(t){var e=4==t.length?t.slice(1):t,n=e[0],r=e[1];return[e[2],r,n]},e.getLayerName=function(t){return t.name?t.name:t.output[0]},e.onnxTensorToTfjsWeigths=h,e.loadImageData=function(t){var e=new Image;return new Promise((function(n,r){e.crossOrigin="anonymous",e.src=t,e.onload=function(){return n(e)},e.onerror=r}))}},783:function(t,e,n){"use strict";var r,o,a,i,u,s=this&&this.__extends||(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),r=n(734),o=n(735),a=function(){function t(t){this.model=t}return t.from=function(t){return new this(t)},t.prototype.getTfjsConfig=function(t,e){var n=o.getTfjsCommonConfig(t),r=this.getTfjsLayerConfig(t,e);return Object.assign({},n,r)},t}(),e.OnnxNode=a,i=function(t){function e(e){var n=t.call(this)||this;return n.weights=e,n}return s(e,t),e.prototype.apply=function(t,e){return this.weights},e.prototype.getClassName=function(){return"WeightInitializer"},e}(r.Initializer),e.WeightInitializer=i},790:function(t,e,n){var r,o,a,i;t.exports=(r={characters:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){var e,n,o,a,i,u,s,c="",l=0;for(t=r.utf8Encode(t);l<t.length;)a=(e=t.charCodeAt(l++))>>2,i=(3&e)<<4|(n=t.charCodeAt(l++))>>4,u=(15&n)<<2|(o=t.charCodeAt(l++))>>6,s=63&o,isNaN(n)?u=s=64:isNaN(o)&&(s=64),c=c+this.characters.charAt(a)+this.characters.charAt(i)+this.characters.charAt(u)+this.characters.charAt(s);return c},utf8Encode:function(t){var e,n,r;for(t=t.replace(/\r\n/g,"\n"),e="",n=0;n<t.length;n++)(r=t.charCodeAt(n))<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128));return e}},o=function(t){return"string"==typeof t?"string":"undefined"!=typeof SVGElement&&t instanceof SVGElement?"element":void 0},a=function(t){var e=(new XMLSerializer).serializeToString(t);return i(e)},i=function(t){return"data:image/svg+xml;base64,"+r.encode(t)},function(t){switch(o(t)){case"string":return i(t);case"element":return a(t);default:return t}})},829:function(t,e,n){"use strict";function r(t,e){return t*e}function o(t,e){if(t%e!=0)throw Error("unpackedSize ("+t+") must be a multiple of "+e);return t/e}function a(t,e){return[Math.ceil(e/2),Math.ceil(t/2)]}function i(t,e){var n=a(t,e);return n[0]*n[1]*4}var u,s,c,l;Object.defineProperty(e,"__esModule",{value:!0}),(l=e.TextureType||(e.TextureType={}))[l.FLOAT=0]="FLOAT",l[l.UNSIGNED_BYTE=1]="UNSIGNED_BYTE",e.getUnpackedMatrixTextureShapeWidthHeight=function(t,e){return[e,t]},e.getUnpackedArraySizeFromMatrixSize=r,e.getColorMatrixTextureShapeWidthHeight=function(t,e){return[4*e,t]},e.getMatrixSizeFromUnpackedArraySize=o,e.encodeMatrixToUnpackedArray=function(t,e,n){var o,a,i=r(t.length,n);if(e.length<i)throw Error("unpackedArray length ("+e.length+") must be >= "+i);for(o=0,a=0;a<t.length;++a)e[o]=t[a],o+=n},e.FLOAT_MAX=2e4,e.FLOAT_MIN=-e.FLOAT_MAX,u=(e.FLOAT_MAX-e.FLOAT_MIN)/255,s=[1,1/255,1/65025,1/16581375],c=[1,255,65025],e.BYTE_NAN_VALUE=0,e.encodeFloatArray=function(t){var n,r=new Uint8Array(4*t.length),o=function(n){var o,a,i=t[n/4];if(isNaN(i))return r[n]=e.BYTE_NAN_VALUE,r[n+1]=e.BYTE_NAN_VALUE,r[n+2]=e.BYTE_NAN_VALUE,r[n+3]=e.BYTE_NAN_VALUE,"continue";o=(i-e.FLOAT_MIN)/u,a=c.map((function(t){return t*o})).map((function(t){return Math.floor(t%1*255)})),r[n]=Math.floor(o),r[n+1]=a[0],r[n+2]=a[1],r[n+3]=a[2]};for(n=0;n<r.length;n+=4)o(n);return r},e.decodeToFloatArray=function(t){var n,r=new Float32Array(t.length/4),o=function(n){var o,a;if(t[n]===e.BYTE_NAN_VALUE&&t[n+1]===e.BYTE_NAN_VALUE&&t[n+2]===e.BYTE_NAN_VALUE&&t[n+3]===e.BYTE_NAN_VALUE)return r[n/4]=NaN,"continue";o=0,s.forEach((function(e,r){o+=e*t[n+r]})),a=o*u+e.FLOAT_MIN,r[n/4]=a};for(n=0;n<t.length;n+=4)o(n);return r},e.decodeMatrixFromUnpackedArray=function(t,e,n){var r,a,i=o(t.length,n);if(e.length<i)throw Error("matrix length ("+e.length+") must be >= "+i);for(r=0,a=0;a<t.length;a+=n)e[r++]=t[a]},e.decodeMatrixFromUnpackedColorRGBAArray=function(t,e,n){var r,o,a,i=t.length*n/4;if(e.length<i)throw Error("matrix length ("+e.length+") must be >= "+i);for(r=0,o=0;o<t.length;o+=4)for(a=0;a<n;a++)e[r++]=t[o+a]},e.getPackedMatrixTextureShapeWidthHeight=a,e.getPackedRGBAArraySizeFromMatrixShape=i,e.encodeMatrixToPackedRGBA=function(t,e,n,r){var o,u,s,c,l,p,f,h,d,g,y,m,v,x,T,b=i(e,n);if(r.length<b)throw Error("packedRGBA length ("+r.length+") must be >= "+b);for(u=(o=a(e,n))[0],s=o[1],c=n%2==1,l=e%2==1,p=Math.floor(n/2),f=Math.floor(e/2),h=c?4:0,d=n,g=0,y=0;y<f;++y){for(m=2*y*n,v=0;v<p;++v)x=m+2*v,r[g]=t[x],r[g+1]=t[x+1],r[g+2]=t[x+d],r[g+3]=t[x+d+1],g+=4;g+=h}if(c)for(x=n-1,g=4*(u-1),T=2*n,h=4*u,y=0;y<f;++y)r[g]=t[x],r[g+2]=t[x+n],x+=T,g+=h;if(l)for(x=(e-1)*n,g=(s-1)*u*4,v=0;v<p;++v)r[g++]=t[x++],r[g++]=t[x++],g+=2;return c&&l&&(r[r.length-4]=t[t.length-1]),r},e.decodeMatrixFromPackedRGBA=function(t,e,n,r){var o,i,u,s,c,l,p,f,h,d,g,y,m,v,x,T=e*n;if(T<r.length)throw Error("matrix length ("+r.length+") must be >= "+T);for(o=n%2==1,i=e%2==1,u=Math.floor(n/2),s=Math.floor(e/2),l=(c=a(e,n))[0],p=c[1],f=o?4:0,h=n+(o?1:0),d=0,g=0,y=n,m=0;m<s;++m){for(v=0;v<u;++v)r[g++]=t[d++],r[g++]=t[d++],r[y++]=t[d++],r[y++]=t[d++];d+=f,g+=h,y+=h}if(o)for(d=4*(l-1),x=n-1,f=4*l,h=2*n,m=0;m<s;++m)r[x]=t[d],r[x+n]=t[d+2],d+=f,x+=h;if(i)for(d=(p-1)*l*4,x=(e-1)*n,v=0;v<u;++v)r[x++]=t[d++],r[x++]=t[d++],d+=2;return o&&i&&(r[r.length-1]=t[t.length-4]),r}},900:function(t,e,n){"use strict";function r(t,e){var n,r=d.ENV.get("WEBGL_VERSION");if(2===r?n=t.getContext("webgl2",e):1===r&&(n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)),0===r||null==n)throw Error("This browser does not support WebGL.");return n}function o(t,e){var n=e();return a(t),n}function a(t){if(g){var e=t.getError();if(e!==t.NO_ERROR)throw Error("WebGL Error: "+i(t,e))}}function i(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function u(t){return null!=f?f:f=o(t,(function(){return t.getParameter(t.MAX_TEXTURE_SIZE)}))}function s(t,e,n){p(t,n),o(t,(function(){return t.activeTexture(t.TEXTURE0+n)})),o(t,(function(){return t.bindTexture(t.TEXTURE_2D,e)}))}function c(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function l(t,e,n){var r=o(t,(function(){return e()}));if(null==r)throw Error(n);return r}function p(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}var f,h,d,g,y;Object.defineProperty(e,"__esModule",{value:!0}),f=null,h=n(630),d=n(632),e.createWebGLRenderingContext=function(t){var e=document.createElement("canvas");return e.width=1,e.height=1,r(e,t)},e.createWebGLRenderingContextFromCanvas=r,e.callAndCheck=o,g=!1,e.enableDebugWebGLErrorChecking=function(t){g=t},e.checkWebGLError=a,e.getWebGLErrorMessage=i,e.getExtensionOrThrow=function(t,e){return l(t,(function(){return t.getExtension(e)}),'Extension "'+e+'" not supported on this browser.')},e.createVertexShader=function(t,e){var n=l(t,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(o(t,(function(){return t.shaderSource(n,e)})),o(t,(function(){return t.compileShader(n)})),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),Error("Failed to compile vertex shader.");return n},e.createFragmentShader=function(t,e){var n=l(t,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(o(t,(function(){return t.shaderSource(n,e)})),o(t,(function(){return t.compileShader(n)})),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw function(t,e){var n,r,o,a,i,u,s,c,l,p=y.exec(e);if(null==p)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(n=+p[1],r=t.split("\n"),o=r.length.toString().length+2,a=r.map((function(t,e){return h.rightPad(""+(e+1),o)+t})),i=0,u=0;u<a.length;u++)i=Math.max(a[u].length,i);s=a.slice(0,n-1),c=a.slice(n-1,n),l=a.slice(n),console.log(s.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+h.rightPad(c[0],i),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(l.join("\n"))}(e,t.getShaderInfoLog(n)),Error("Failed to compile fragment shader.");return n},y=/ERROR: [0-9]+:([0-9]+):/g,e.createProgram=function(t){return l(t,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")},e.linkProgram=function(t,e){if(o(t,(function(){return t.linkProgram(e)})),!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),Error("Failed to link vertex and fragment shaders.")},e.validateProgram=function(t,e){if(o(t,(function(){return t.validateProgram(e)})),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),Error("Shader program validation failed.")},e.createStaticVertexBuffer=function(t,e){var n=l(t,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return o(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,n)})),o(t,(function(){return t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)})),n},e.createStaticIndexBuffer=function(t,e){var n=l(t,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return o(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)})),o(t,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)})),n},e.queryMaxTextureSize=u,e.getChannelsPerTexture=function(){return d.ENV.get("WEBGL_FLOAT_TEXTURE_ENABLED")&&2===d.ENV.get("WEBGL_VERSION")?1:4},e.createTexture=function(t){return l(t,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")},e.validateTextureSize=function(t,e,n){var r=u(t);if(e<=0||n<=0)throw Error("Requested texture size ["+e+"x"+n+"] is invalid.");if(e>r||n>r)throw Error("Requested texture size ["+e+"x"+n+"] greater than WebGL maximum on this browser / GPU ["+r+"x"+r+"].")},e.createFramebuffer=function(t){return l(t,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")},e.bindVertexBufferToProgramAttribute=function(t,e,n,r,a,i,u){var s=t.getAttribLocation(e,n);return-1!==s&&(o(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),o(t,(function(){return t.vertexAttribPointer(s,a,t.FLOAT,!1,i,u)})),o(t,(function(){return t.enableVertexAttribArray(s)})),!0)},e.bindTextureUnit=s,e.unbindTextureUnit=function(t,e){p(t,e),o(t,(function(){return t.activeTexture(t.TEXTURE0+e)})),o(t,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},e.getProgramUniformLocationOrThrow=function(t,e,n){return l(t,(function(){return t.getUniformLocation(e,n)}),'uniform "'+n+'" not present in program.')},e.getProgramUniformLocation=function(t,e,n){return t.getUniformLocation(e,n)},e.bindTextureToProgramUniformSampler=function(t,e,n,r,a){o(t,(function(){return s(t,n,a)})),o(t,(function(){return t.uniform1i(r,a)}))},e.bindCanvasToFramebuffer=function(t){o(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),o(t,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),o(t,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},e.bindColorTextureToFramebuffer=function(t,e,n){o(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),o(t,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}))},e.unbindColorTextureFromFramebuffer=function(t,e){o(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,e)})),o(t,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))},e.validateFramebuffer=function(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw Error("Error binding framebuffer: "+c(t,e))},e.getFramebufferErrorMessage=c,e.getTextureShapeFromLogicalShape=function(t,e){var n,r;return 2!==e.length&&(e=h.squeezeShape(e).newShape),n=u(t),r=h.sizeFromShape(e),e.length<=1&&r<=n?[r,1]:2===e.length&&e[0]<=n&&e[1]<=n?e:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?[e[0],e[1]*e[2]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n?[e[0],e[1]*e[2]*e[3]]:h.sizeToSquarishShape(r)}}}]);